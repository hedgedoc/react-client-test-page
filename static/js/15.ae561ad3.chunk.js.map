{"version":3,"sources":["components/editor/document-bar/connection-indicator/active-indicator.tsx","components/common/icon-button/translated-icon-button.tsx","components/editor/document-bar/buttons/pin-to-history-button.tsx","components/editor/document-bar/buttons/share-link-button.tsx","components/editor/document-bar/permissions/permission-group-entry.tsx","components/editor/document-bar/connection-indicator/user-line.tsx","components/editor/document-bar/connection-indicator/connection-indicator.tsx","components/editor/document-bar/document-info/unitalic-bold-text.tsx","components/editor/document-bar/document-info/document-info-button.tsx","components/editor/document-bar/menus/editor-menu.tsx","components/editor/document-bar/menus/export/markdown.tsx","components/editor/document-bar/menus/export-menu.tsx","components/common/hidden-input-menu-entry/hidden-input-menu-entry.tsx","components/editor/document-bar/menus/import-menu.tsx","components/common/cache/cache.ts","api/users/index.ts","components/editor/document-bar/permissions/permission-list.tsx","components/editor/editor-pane/tool-bar/editor-preferences/editor-preference-input.tsx","components/editor/document-bar/permissions/permission-modal.tsx","components/editor/document-bar/permissions/permission-button.tsx","api/revisions/index.ts","components/editor/document-bar/revisions/revision-modal-list-entry.tsx","components/editor/document-bar/revisions/revision-modal.tsx","components/editor/document-bar/revisions/utils.ts","components/editor/document-bar/revisions/revision-button.tsx","components/editor/document-bar/document-bar.tsx","components/editor/document-renderer-pane/scrolling-document-render-pane.tsx","components/editor/scroll/hooks/use-scroll-to-line-mark.ts","components/editor/scroll/utils.ts","components/editor/scroll/hooks/use-user-scroll.ts","components/editor/editor-modals/max-length-warning-modal.tsx","components/editor/editor-pane/autocompletion/code-block.ts","components/editor/editor-pane/autocompletion/collapsable-block.ts","components/editor/editor-pane/autocompletion/container.ts","components/editor/editor-pane/tool-bar/emoji-picker/forkawesome.png","components/editor/editor-pane/tool-bar/emoji-picker/emoji-picker.tsx","components/editor/editor-pane/tool-bar/utils/emojiUtils.ts","components/editor/editor-pane/autocompletion/emoji.ts","components/editor/editor-pane/autocompletion/header.ts","components/editor/editor-pane/autocompletion/image.ts","components/editor/editor-pane/autocompletion/link-and-extra-tag.ts","components/editor/editor-pane/autocompletion/pdf.ts","components/editor/editor-pane/autocompletion/index.ts","components/common/number-range/number-range.ts","components/editor/editor-pane/tool-bar/utils/toolbarButtonUtils.ts","components/editor/editor-pane/key-map.ts","components/editor/editor-pane/status-bar/status-bar.tsx","components/editor/editor-pane/tool-bar/utils/upload-image-mimetypes.ts","components/editor/editor-pane/upload-handler.ts","components/editor/editor-pane/tool-bar/editor-preferences/editor-preference-property.ts","components/editor/editor-pane/tool-bar/editor-preferences/editor-preference-boolean-property.tsx","components/editor/editor-pane/tool-bar/editor-preferences/editor-preference-ligatures-select.tsx","components/editor/editor-pane/tool-bar/editor-preferences/editor-preference-number-property.tsx","components/editor/editor-pane/tool-bar/editor-preferences/editor-preference-select-property.tsx","components/editor/editor.tsx","components/editor/editor-pane/tool-bar/editor-preferences/editor-preferences.tsx","components/editor/editor-pane/tool-bar/emoji-picker/emoji-picker-button.tsx","components/editor/editor-pane/tool-bar/table-picker/custom-table-size-modal.tsx","components/editor/editor-pane/tool-bar/table-picker/table-picker.tsx","components/editor/editor-pane/tool-bar/table-picker/table-picker-button.tsx","components/editor/editor-pane/tool-bar/tool-bar.tsx","components/editor/editor-pane/editor-pane.tsx","components/editor/editorTestContent.ts","components/editor/hooks/useViewModeShortcuts.ts","components/editor/splitter/split-divider/split-divider.tsx","components/editor/splitter/splitter.tsx"],"names":["ActiveIndicatorStatus","TranslatedIconButton","i18nKey","props","Trans","PinToHistoryButton","useTranslation","size","className","icon","variant","ShareLinkButton","useState","showShareDialog","setShowShareDialog","noteMetadata","useSelector","state","documentContent","metadata","equal","editorMode","editorConfig","baseUrl","useFrontendBaseUrl","id","useParams","onClick","show","onHide","closeButton","titleI18nKey","Modal","Body","content","nativeShareButton","url","condition","type","GroupMode","ActiveIndicator","status","UserLine","name","photo","color","style","borderLeftColor","additionalClasses","ConnectionIndicator","Dropdown","alignRight","Toggle","Menu","Item","disabled","INACTIVE","ACTIVE","UnitalicBoldText","text","DocumentInfoButton","showModal","setShowModal","ListGroup","mode","DocumentInfoLineWithTimeMode","CREATED","time","DateTime","local","minus","days","userName","profileImageSrc","EDITED","minutes","EditorMenu","noteTitle","itemI18nKey","modalButtonI18nKey","modalIcon","modalQuestionI18nKey","modalTitleI18nKey","modalWarningI18nKey","onConfirm","console","log","MarkdownExportDropdownItem","title","markdownContent","download","ExportMenu","Header","Divider","dir","href","links","faq","target","rel","HiddenInputMenuEntry","acceptedFiles","onLoad","t","fileInputReference","useRef","useCallback","fileInput","current","addEventListener","files","length","file","then","value","catch","error","click","ref","accept","Button","ImportMenu","onImportMarkdown","Promise","resolve","reject","fileReader","FileReader","newContent","result","setDocumentContent","readAsText","Cache","lifetime","maxEntries","store","Map","entryLifetime","Error","this","key","has","entry","get","entryCreated","Date","now","data","delete","keys","next","set","cache","getUserById","userid","a","fetch","getApiUrl","defaultFetchConfig","response","expectResponseCode","json","userData","put","EditMode","PermissionGroupEntry","editMode","onChangeEditMode","ToggleButtonGroup","onChange","ToggleButton","NONE","VIEW","EDIT","EditorPreferenceInputType","PermissionList","list","identifier","changeEditMode","removeEntry","createEntry","editI18nKey","viewI18nKey","removeI18nKey","addI18nKey","newEntry","setNewEntry","addEntry","map","canEdit","onSubmit","event","preventDefault","InputGroup","FormControl","placeholder","aria-label","currentTarget","permissionsApiResponse","owner","sharedTo","username","sharedToGroup","PermissionModal","onChangeShow","setError","userList","setUserList","setOwner","allUserPermissions","setAllUserPermissions","allLoggedInUserPermissions","setAllLoggedInUserPermissions","useEffect","forEach","shareUser","concat","sharedGroup","Alert","userId","user","filter","PermissionButton","showPermissionModal","setShowPermissionModal","revisionCache","getRevision","noteId","timestamp","cacheKey","revisionData","getAllRevisions","RevisionModalListEntry","active","revision","revisionAuthorListMap","as","fromMillis","toFormat","index","showName","RevisionModal","revisions","setRevisions","selectedRevisionTimestamp","setSelectedRevisionTimestamp","selectedRevision","setSelectedRevision","darkModeEnabled","useIsDarkModeActivated","fetchedRevisions","authorData","authors","users","author","push","getUserDataForRevision","fetchedRevision","Row","Col","lg","revisionIndex","oldValue","newValue","splitView","compareMethod","DiffMethod","WORDS","useDarkTheme","Footer","window","alert","RevisionButton","setShow","DocumentBar","ScrollingDocumentRenderPane","scrollState","wide","onFirstHeadingChange","onMakeScrollSource","onMetadataChange","onScroll","onTaskCheckedChange","renderer","lineMarks","setLineMarks","contentLineCount","lastScrollPosition","scrollTo","targetPosition","top","firstLineInView","line","offsetHeight","lineNumber","lastMarkBefore","firstMarkAfter","i","currentMark","findLineMarks","positionBefore","position","positionAfter","lastMarkBeforeLine","lineHeight","scrolledPercentage","correctedPosition","Math","floor","useScrollToLineMark","useMemo","split","userScroll","scrollTop","lineMarksBeforeScrollTop","lineMark","lineMarksAfterScrollTop","beforeLineMark","reduce","prevLineMark","currentLineMark","afterLineMark","componentHeight","distanceToBefore","percentageRaw","lineCount","innerScrolling","useUserScroll","extraClasses","documentRenderPaneRef","onLineMarkerPositionChanged","onMouseEnterRenderer","onScrollRenderer","MaxLengthWarningModal","maxLength","data-cy","values","wordRegExp","allSupportedLanguages","CodeBlockHinter","hint","editor","hljs","searchTerm","findWordAtCursor","searchResult","exec","term","default","listLanguages","suggestions","search","cursor","getCursor","suggestion","displayText","from","Pos","start","to","end","CollapsableBlockHinter","validAlertLevels","ContainerHinter","startsWith","emojiPickerConfig","customEmoji","Object","ForkAwesomeIcons","shortcodes","toLowerCase","forkawesomeIcon","category","dataSource","EmojiPicker","onEmojiSelected","onDismiss","pickerContainerRef","pickerRef","useClickAway","picker","Picker","shadowRoot","appendChild","document","createElement","textContent","twemojiStyle","remove","undefined","emojiClick","detail","removeEventListener","setAttribute","removeAttribute","getEmojiShortCode","emoji","skinToneModifier","skins","skinTone","emojiIndex","Database","emojiWordRegex","findEmojiInDatabase","getTopFavoriteEmoji","getEmojiBySearchQuery","queryResult","convertEmojiEventToHint","emojiData","shortCode","render","parent","wrapper","innerHTML","unicode","generateEmojiHints","suggestionList","getPreferredSkinTone","emojiEventDetails","hints","o","EmojiHinter","allSupportedHeaders","allSupportedHeadersTextToInsert","HeaderHinter","indexOf","allSupportedImages","ImageHinter","allSupportedLinks","LinkAndExtraTagHinter","getUser","PDFHinter","allowedChars","getLine","ch","test","charAt","slice","item","allHinters","createNumberRangeArray","Array","makeSelectionBold","wrapTextWith","makeSelectionItalic","strikeThroughSelection","underlineSelection","markSelection","symbol","endSymbol","getSelection","ranges","listSelections","range","empty","selection","getRange","replaceRange","head","anchor","setSelections","wrapTextWithOrJustPut","replacement","insertOnStartOfLines","lines","join","changeLines","replaceFunction","createList","listMark","addLink","prefix","insertAtCursor","f10","setOption","getOption","esc","keyMapName","substr","CodeMirror","Pass","suppressKey","tab","match","spaces","getSelections","execCommand","pos","replaceSelection","defaultKeyMap","isMac","F9","F10","Esc","Enter","Tab","Home","End","defaultState","selectedColumns","selectedLines","linesInDocument","charactersInDocument","remainingCharacters","createStatusInfo","maxDocumentLength","getValue","StatusBar","getLengthTooltip","exceeded","remaining","columns","count","supportedMimeTypes","supportedMimeTypesJoined","handleUpload","mimeType","includes","uploadPlaceholder","i18n","fileName","getState","uploadFile","link","getCorrectSyntaxForLink","EditorPreferenceProperty","EditorPreferenceInput","property","children","Form","Group","controlId","Label","NUMBER","Control","EditorPreferenceBooleanProperty","preference","preferences","toString","selectItem","selectedItem","mergeEditorPreferences","i18nPrefix","SELECT","EditorPreferenceLigaturesSelect","ligaturesEnabled","Boolean","ligatures","saveLigatures","ligaturesActivated","setEditorLigatures","BOOLEAN","EditorPreferenceNumberProperty","Number","parseInt","ScrollSource","EditorPreferenceSelectProperty","selections","EditorPreferences","indentWithTabs","THEME","KEYMAP","INDENT_WITH_TABS","INDENT_UNIT","SPELL_CHECK","EmojiPickerButton","showEmojiPicker","setShowEmojiPicker","addEmoji","old","CustomTableSizeModal","onTablePicked","rows","tableSize","setTableSize","min","isInvalid","isNaN","fixedWidth","ModalFooter","TablePicker","containerRef","showDialog","setShowDialog","role","cols","row","col","onMouseEnter","TablePickerButton","showTablePicker","setShowTablePicker","rowArray","colArray","divider","body","table","addTable","ToolBar","onUploadImage","ButtonToolbar","ButtonGroup","subscriptSelection","superscriptSelection","addHeaderLevel","addCodeFences","addQuotes","addList","j","addOrderedList","addTaskList","addImage","addLine","addCollapsableBlock","addComment","hinter","showHint","completeSingle","completeOnSingleClick","alignWithWord","onPaste","pasteEditor","clipboardData","EditorPane","onContentChange","config","showMaxLengthWarning","setShowMaxLengthWarning","maxLengthWarningAlreadyShown","setEditor","statusBarInfo","setStatusBarInfo","editorPreferences","editorScroll","setEditorScroll","onEditorScroll","scrollEventValue","lineAtHeight","startYOfLine","heightAtLine","lineInfo","heightOfLine","handle","height","max","percentage","newPositionRaw","newPosition","onBeforeChange","onEditorDidMount","mountedEditor","onCursorActivity","editorWithActivity","onDrop","dropEditor","pageX","pageY","dataTransfer","left","newCursor","coordsChar","setCursor","onMaxLengthHide","codeMirrorOptions","viewportMargin","styleActiveLine","lineNumbers","lineWrapping","showCursorWhenSelecting","highlightSelectionMatches","inputStyle","matchBrackets","autoCloseBrackets","matchTags","bothTags","autoCloseTags","foldGutter","gutters","extraKeys","flattenSpans","addModeClass","autoRefresh","options","editorDidMount","editorTestContent","isTestMode","shortcutHandler","ctrlKey","altKey","setEditorMode","EditorMode","BOTH","PREVIEW","EDITOR","SplitDivider","onGrab","onMouseDown","onTouchStart","Splitter","containerClassName","right","showLeft","showRight","setSplit","realSplit","doResizing","setDoResizing","splitContainer","recalculateSize","mouseXPosition","newSize","offsetLeft","clientWidth","onMouseUp","onTouchEnd","onMouseMove","mouseEvent","onTouchMove","touchEvent","touches","flexBasis","TASK_REGEX","Editor","useLocation","untitledNote","isWide","useMedia","minWidth","documentTitle","setDocumentTitle","firstHeading","scrollSource","editorSyncScroll","syncScroll","editorScrollState","rendererScrollState","setScrollState","requestedMode","find","updateDocumentTitle","extractNoteTitle","newFirstHeading","metaData","setDocumentMetadata","lineInMarkdown","checked","results","before","after","setNoteId","onMarkdownRendererScroll","newScrollState","RENDERER","useApplyDarkMode","useDocumentTitle","AppBarMode"],"mappings":"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","file":"static/js/15.ae561ad3.chunk.js","sourcesContent":["/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport './active-indicator.scss'\n\nexport enum ActiveIndicatorStatus {\n  ACTIVE = 'active',\n  INACTIVE = 'inactive'\n}\n\nexport interface ActiveIndicatorProps {\n  status: ActiveIndicatorStatus;\n}\n\nexport const ActiveIndicator: React.FC<ActiveIndicatorProps> = ({ status }) => {\n  return (\n    <span className={`activeIndicator ${status}`}/>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { Trans } from 'react-i18next'\nimport { IconButton, IconButtonProps } from './icon-button'\n\nexport interface TranslatedIconButtonProps extends IconButtonProps {\n  i18nKey: string\n}\n\nexport const TranslatedIconButton: React.FC<TranslatedIconButtonProps> = ({ i18nKey, ...props }) => {\n  return (\n    <IconButton {...props}>\n      <Trans i18nKey={i18nKey}/>\n    </IconButton>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { TranslatedIconButton } from '../../../common/icon-button/translated-icon-button'\n\nexport const PinToHistoryButton: React.FC = () => {\n  useTranslation()\n\n  const isPinned = true\n  const i18nKey = isPinned ? 'editor.documentBar.pinNoteToHistory' : 'editor.documentBar.pinnedToHistory'\n\n  return <TranslatedIconButton size={'sm'} className={'mx-1'} icon={'thumb-tack'} variant={'light'} i18nKey={i18nKey}/>\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport equal from 'fast-deep-equal'\nimport React, { Fragment, useState } from 'react'\nimport { Modal } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { useParams } from 'react-router-dom'\nimport { useFrontendBaseUrl } from '../../../../hooks/common/use-frontend-base-url'\nimport { ApplicationState } from '../../../../redux'\nimport { CopyableField } from '../../../common/copyable/copyable-field/copyable-field'\nimport { TranslatedIconButton } from '../../../common/icon-button/translated-icon-button'\nimport { CommonModal } from '../../../common/modals/common-modal'\nimport { ShowIf } from '../../../common/show-if/show-if'\nimport { EditorPathParams } from '../../editor'\n\nexport const ShareLinkButton: React.FC = () => {\n  useTranslation()\n  const [showShareDialog, setShowShareDialog] = useState(false)\n  const noteMetadata = useSelector((state: ApplicationState) => state.documentContent.metadata, equal)\n  const editorMode = useSelector((state: ApplicationState) => state.editorConfig.editorMode)\n  const baseUrl = useFrontendBaseUrl()\n  const { id } = useParams<EditorPathParams>()\n\n  return (\n    <Fragment>\n      <TranslatedIconButton\n        size={'sm'}\n        className={'mx-1'}\n        icon={'share'}\n        variant={'light'}\n        onClick={() => setShowShareDialog(true)}\n        i18nKey={'editor.documentBar.shareLink'}\n      />\n      <CommonModal\n        show={showShareDialog}\n        onHide={() => setShowShareDialog(false)}\n        closeButton={true}\n        titleI18nKey={'editor.modal.shareLink.title'}>\n        <Modal.Body>\n          <Trans i18nKey={'editor.modal.shareLink.editorDescription'}/>\n          <CopyableField content={`${baseUrl}/n/${id}?${editorMode}`} nativeShareButton={true} url={`${baseUrl}/n/${id}?${editorMode}`}/>\n          <ShowIf condition={noteMetadata.type === 'slide'}>\n            <Trans i18nKey={'editor.modal.shareLink.slidesDescription'}/>\n            <CopyableField content={`${baseUrl}/p/${id}`} nativeShareButton={true} url={`${baseUrl}/p/${id}`}/>\n          </ShowIf>\n          <ShowIf condition={noteMetadata.type === ''}>\n            <Trans i18nKey={'editor.modal.shareLink.viewOnlyDescription'}/>\n            <CopyableField content={`${baseUrl}/s/${id}`} nativeShareButton={true} url={`${baseUrl}/s/${id}`}/>\n          </ShowIf>\n        </Modal.Body>\n      </CommonModal>\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { ToggleButton, ToggleButtonGroup } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\n\nexport interface PermissionGroupEntryProps {\n  title: string\n  editMode: GroupMode\n  onChangeEditMode: (newMode: GroupMode) => void\n}\n\nexport enum GroupMode {\n  NONE,\n  VIEW,\n  EDIT,\n}\n\nexport const PermissionGroupEntry: React.FC<PermissionGroupEntryProps> = ({ title, editMode, onChangeEditMode }) => {\n  const { t } = useTranslation()\n\n  return (\n    <li className={'list-group-item d-flex flex-row justify-content-between align-items-center'}>\n      <Trans i18nKey={title}/>\n      <ToggleButtonGroup\n        type='radio'\n        name='edit-mode'\n        value={editMode}\n        onChange={onChangeEditMode}\n      >\n        <ToggleButton\n          title={ t('editor.modal.permissions.denyGroup', { name: t(title) })}\n          variant={'light'}\n          className={'text-secondary'}\n          value={GroupMode.NONE}\n        >\n          <ForkAwesomeIcon icon='ban'/>\n        </ToggleButton>\n        <ToggleButton\n          title={ t('editor.modal.permissions.viewOnlyGroup', { name: t(title) })}\n          variant={'light'}\n          className={'text-secondary'}\n          value={GroupMode.VIEW}\n        >\n          <ForkAwesomeIcon icon='eye'/>\n        </ToggleButton>\n        <ToggleButton\n          title={t('editor.modal.permissions.editGroup', { name: t(title) })}\n          variant={'light'}\n          className={'text-secondary'}\n          value={GroupMode.EDIT}\n        >\n          <ForkAwesomeIcon icon='pencil'/>\n        </ToggleButton>\n      </ToggleButtonGroup>\n    </li>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { Fragment } from 'react'\nimport { UserAvatar } from '../../../common/user-avatar/user-avatar'\nimport { ActiveIndicator, ActiveIndicatorStatus } from './active-indicator'\nimport './user-line.scss'\n\nexport interface UserLineProps {\n  name: string;\n  photo: string;\n  color: string;\n  status: ActiveIndicatorStatus;\n}\n\nexport const UserLine: React.FC<UserLineProps> = ({ name, photo, color, status }) => {\n  return (\n    <Fragment>\n      <div className='d-inline-flex align-items-bottom user-line-color-indicator' style={{ borderLeftColor: color }}/>\n      <UserAvatar photo={photo} name={name} additionalClasses={'mx-2'}/>\n      <ActiveIndicator status={status} />\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\nimport { ActiveIndicatorStatus } from './active-indicator'\nimport { UserLine } from './user-line'\n\nconst ConnectionIndicator: React.FC = () => {\n  const userOnline = 2\n  return (\n    <Dropdown className=\"small mx-2\" alignRight>\n      <Dropdown.Toggle id=\"connection-indicator\" size=\"sm\" variant=\"primary\" className=\"text-uppercase\">\n        <ForkAwesomeIcon icon=\"users\" className={'mr-1'}/> {userOnline} Online\n      </Dropdown.Toggle>\n      <Dropdown.Menu>\n        <Dropdown.Item disabled={true} className=\"d-flex align-items-center p-0\">\n          <UserLine name=\"Philip Molares\" photo=\"/img/avatar.png\" color=\"red\" status={ActiveIndicatorStatus.INACTIVE}/>\n        </Dropdown.Item>\n        <Dropdown.Item disabled={true} className=\"d-flex align-items-center p-0\">\n          <UserLine name=\"Philip Molares\" photo=\"/img/avatar.png\" color=\"blue\" status={ActiveIndicatorStatus.ACTIVE}/>\n        </Dropdown.Item>\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n}\n\nexport { ConnectionIndicator }\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\n\nexport interface UnitalicBoldTextProps {\n  text: string ;\n}\n\nexport const UnitalicBoldText: React.FC<UnitalicBoldTextProps> = ({ text }) => {\n  return <b className={'font-style-normal mr-1'}>{text}</b>\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { DateTime } from 'luxon'\nimport React, { Fragment, useState } from 'react'\nimport { ListGroup, Modal } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { TranslatedIconButton } from '../../../common/icon-button/translated-icon-button'\nimport { CommonModal } from '../../../common/modals/common-modal'\nimport { DocumentInfoLine } from './document-info-line'\nimport { DocumentInfoLineWithTimeMode, DocumentInfoTimeLine } from './document-info-time-line'\nimport { UnitalicBoldText } from './unitalic-bold-text'\n\nexport const DocumentInfoButton: React.FC = () => {\n  const [showModal, setShowModal] = useState(false)\n  useTranslation()\n\n  return (\n    <Fragment>\n      <TranslatedIconButton size={'sm'} className={'mx-1'} icon={'line-chart'} variant={'light'} onClick={() => setShowModal(true)} i18nKey={'editor.documentBar.documentInfo'}/>\n      <CommonModal\n        show={showModal}\n        onHide={() => setShowModal(false)}\n        closeButton={true}\n        titleI18nKey={'editor.modal.documentInfo.title'}>\n        <Modal.Body>\n          <ListGroup>\n            <ListGroup.Item>\n              <DocumentInfoTimeLine\n                size={'2x'}\n                mode={DocumentInfoLineWithTimeMode.CREATED}\n                time={DateTime.local().minus({ days: 11 })}\n                userName={'Tilman'}\n                profileImageSrc={'/img/avatar.png'}/>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <DocumentInfoTimeLine\n                size={'2x'}\n                mode={DocumentInfoLineWithTimeMode.EDITED}\n                time={DateTime.local().minus({ minutes: 3 })}\n                userName={'Philip'}\n                profileImageSrc={'/img/avatar.png'}/>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <DocumentInfoLine icon={'users'} size={'2x'}>\n                <Trans i18nKey='editor.modal.documentInfo.usersContributed'>\n                  <UnitalicBoldText text={'42'}/>\n                </Trans>\n              </DocumentInfoLine>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <DocumentInfoLine icon={'history'} size={'2x'}>\n                <Trans i18nKey='editor.modal.documentInfo.revisions'>\n                  <UnitalicBoldText text={'192'}/>\n                </Trans>\n              </DocumentInfoLine>\n            </ListGroup.Item>\n          </ListGroup>\n        </Modal.Body>\n      </CommonModal>\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { DropdownItemWithDeletionModal } from '../../../history-page/entry-menu/dropdown-item-with-deletion-modal'\n\nexport interface EditorMenuProps {\n  noteTitle: string\n}\n\nexport const EditorMenu: React.FC<EditorMenuProps> = ({ noteTitle }) => {\n  useTranslation()\n\n  return (\n    <Dropdown className={'small mx-1'} alignRight={true}>\n      <Dropdown.Toggle variant='light' size='sm' id='editor-menu'>\n        <Trans i18nKey={'editor.documentBar.menu'}/>\n      </Dropdown.Toggle>\n\n      <Dropdown.Menu>\n        <DropdownItemWithDeletionModal\n          itemI18nKey={'landing.history.menu.deleteNote'}\n          modalButtonI18nKey={'editor.modal.deleteNote.button'}\n          modalIcon={'trash'}\n          modalQuestionI18nKey={'editor.modal.deleteNote.question'}\n          modalTitleI18nKey={'editor.modal.deleteNote.title'}\n          modalWarningI18nKey={'editor.modal.deleteNote.warning'}\n          noteTitle={noteTitle}\n          className={'small'}\n          onConfirm={() => console.log('deleted')}/>\n\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../../redux'\nimport { download } from '../../../../common/download/download'\nimport { ForkAwesomeIcon } from '../../../../common/fork-awesome/fork-awesome-icon'\n\nexport interface MarkdownExportDropdownItemProps {\n  title: string\n}\n\nexport const MarkdownExportDropdownItem: React.FC<MarkdownExportDropdownItemProps> = ({ title }) => {\n  const markdownContent = useSelector((state: ApplicationState) => state.documentContent.content)\n\n  return (\n    <Dropdown.Item className='small' onClick={() => download(markdownContent, `${title}.md`, 'text/markdown')}>\n      <ForkAwesomeIcon icon='file-text' className={'mx-2'}/>\n      Markdown\n    </Dropdown.Item>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport links from '../../../../links.json'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\nimport { MarkdownExportDropdownItem } from './export/markdown'\n\nexport interface ExportMenuProps {\n  title: string\n}\n\nexport const ExportMenu: React.FC<ExportMenuProps> = ({ title }) => {\n  useTranslation()\n  return (\n    <Dropdown className='small mx-1' alignRight={true}>\n      <Dropdown.Toggle variant='light' size='sm' id='editor-menu-export' className=''>\n        <Trans i18nKey='editor.documentBar.export'/>\n      </Dropdown.Toggle>\n\n      <Dropdown.Menu>\n        <Dropdown.Header>\n          <Trans i18nKey='common.export'/>\n        </Dropdown.Header>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='dropbox' className={'mx-2'}/>\n          Dropbox\n        </Dropdown.Item>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='github' className={'mx-2'}/>\n          Gist\n        </Dropdown.Item>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='gitlab' className={'mx-2'}/>\n          Gitlab Snippet\n        </Dropdown.Item>\n\n        <Dropdown.Divider/>\n\n        <Dropdown.Header>\n          <Trans i18nKey='editor.documentBar.download'/>\n        </Dropdown.Header>\n        <MarkdownExportDropdownItem title={title} />\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='file-code-o' className={'mx-2'}/>\n          HTML\n        </Dropdown.Item>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='file-code-o' className={'mx-2'}/>\n          <Trans i18nKey='editor.export.rawHtml'/>\n        </Dropdown.Item>\n\n        <Dropdown.Divider/>\n\n        <Dropdown.Item className='small text-muted' dir={'auto'} href={links.faq} target={'_blank'} rel='noopener noreferrer'>\n          <ForkAwesomeIcon icon='file-pdf-o' className={'mx-2'}/>\n          <Trans i18nKey={'editor.export.pdf'}/>\n          &nbsp;\n          <span className={'text-primary'}>\n            <Trans i18nKey={'common.why'}/>\n          </span>\n        </Dropdown.Item>\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { Fragment, useCallback, useRef } from 'react'\nimport { Button, Dropdown } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../fork-awesome/fork-awesome-icon'\nimport { IconName } from '../fork-awesome/types'\n\nexport interface HiddenInputMenuEntryProps {\n  type: 'dropdown' | 'button'\n  acceptedFiles: string\n  i18nKey: string\n  icon: IconName\n  onLoad: (file: File) => Promise<void>\n}\n\nexport const HiddenInputMenuEntry: React.FC<HiddenInputMenuEntryProps> = ({ type, acceptedFiles, i18nKey, icon, onLoad }) => {\n  const { t } = useTranslation()\n\n  const fileInputReference = useRef<HTMLInputElement>(null)\n  const onClick = useCallback(() => {\n    const fileInput = fileInputReference.current\n    if (!fileInput) {\n      return\n    }\n    fileInput.addEventListener('change', () => {\n      if (!fileInput.files || fileInput.files.length < 1) {\n        return\n      }\n      const file = fileInput.files[0]\n      onLoad(file).then(() => {\n        fileInput.value = ''\n      }).catch((error) => {\n        console.error(error)\n      })\n    })\n    fileInput.click()\n  }, [onLoad])\n\n  return (\n    <Fragment>\n      <input type='file' ref={fileInputReference} className='d-none' accept={acceptedFiles}/>\n      {\n        type === 'dropdown'\n          ? <Dropdown.Item className={'small import-md-file'} onClick={onClick}>\n              <ForkAwesomeIcon icon={icon} className={'mx-2'}/>\n              <Trans i18nKey={i18nKey}/>\n            </Dropdown.Item>\n          : <Button variant='light' onClick={onClick} title={t(i18nKey)}>\n              <ForkAwesomeIcon icon={icon}/>\n            </Button>\n      }\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { useCallback } from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { Trans } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../redux'\nimport { setDocumentContent } from '../../../../redux/document-content/methods'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\nimport { HiddenInputMenuEntry } from '../../../common/hidden-input-menu-entry/hidden-input-menu-entry'\n\nexport const ImportMenu: React.FC = () => {\n  const markdownContent = useSelector((state: ApplicationState) => state.documentContent.content)\n\n  const onImportMarkdown = useCallback((file: File) => {\n    return new Promise<void>((resolve, reject) => {\n      const fileReader = new FileReader()\n      fileReader.addEventListener('load', () => {\n        const newContent = fileReader.result as string\n        if (markdownContent.length === 0) {\n          setDocumentContent(newContent)\n        } else {\n          setDocumentContent(markdownContent + '\\n' + newContent)\n        }\n      })\n      fileReader.addEventListener('loadend', () => {\n        resolve()\n      })\n      fileReader.addEventListener('error', (error) => {\n        reject(error)\n      })\n      fileReader.readAsText(file)\n    })\n  }, [markdownContent])\n\n  return (\n    <Dropdown className='small mx-1' alignRight={true}>\n      <Dropdown.Toggle variant='light' size='sm' id='editor-menu-import' className=''>\n        <Trans i18nKey='editor.documentBar.import'/>\n      </Dropdown.Toggle>\n\n      <Dropdown.Menu>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='dropbox' className={'mx-2'}/>\n          Dropbox\n        </Dropdown.Item>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='github' className={'mx-2'}/>\n          Gist\n        </Dropdown.Item>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='gitlab' className={'mx-2'}/>\n          Gitlab Snippet\n        </Dropdown.Item>\n        <Dropdown.Item className='small'>\n          <ForkAwesomeIcon icon='clipboard' className={'mx-2'}/>\n          <Trans i18nKey='editor.import.clipboard'/>\n        </Dropdown.Item>\n        <HiddenInputMenuEntry\n          type={'dropdown'}\n          acceptedFiles={'.md, text/markdown, text/plain'}\n          i18nKey={'editor.import.file'}\n          icon={'file-text-o'}\n          onLoad={onImportMarkdown}\n        />\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nexport interface CacheEntry<T> {\n  entryCreated: number\n  data: T\n}\n\nexport class Cache<K, V> {\n  private store = new Map<K, CacheEntry<V>>()\n\n  readonly entryLifetime: number\n  readonly maxEntries: number\n\n  constructor (lifetime: number, maxEntries = 0) {\n    if (lifetime < 0) {\n      throw new Error('Cache entry lifetime can not be less than 0 seconds.')\n    }\n    this.entryLifetime = lifetime\n    this.maxEntries = maxEntries\n  }\n\n  has (key: K): boolean {\n    if (!this.store.has(key)) {\n      return false\n    }\n    const entry = this.store.get(key)\n    return (!!entry && entry.entryCreated >= (Date.now() - this.entryLifetime * 1000))\n  }\n\n  get (key: K): V {\n    const entry = this.store.get(key)\n    if (!entry) {\n      throw new Error('This cache entry does not exist. Check with \".has()\" before using \".get()\".')\n    }\n    return entry.data\n  }\n\n  put (key: K, value: V): void {\n    if (this.maxEntries > 0 && this.store.size === this.maxEntries) {\n      this.store.delete(this.store.keys().next().value)\n    }\n    this.store.set(key, {\n      entryCreated: Date.now(),\n      data: value\n    })\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Cache } from '../../components/common/cache/cache'\nimport { defaultFetchConfig, expectResponseCode, getApiUrl } from '../utils'\nimport { UserResponse } from './types'\n\nconst cache = new Cache<string, UserResponse>(600)\n\nexport const getUserById = async (userid: string): Promise<UserResponse> => {\n  if (cache.has(userid)) {\n    return cache.get(userid)\n  }\n  const response = await fetch(`${getApiUrl()}/users/${userid}`, {\n    ...defaultFetchConfig\n  })\n  expectResponseCode(response)\n  const userData = (await response.json()) as UserResponse\n  cache.put(userid, userData)\n  return userData\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { ReactElement, useState } from 'react'\nimport { Button, FormControl, InputGroup, ToggleButton, ToggleButtonGroup } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\nimport { Principal } from './permission-modal'\n\nexport interface PermissionListProps {\n  list: Principal[]\n  identifier: (entry: Principal) => ReactElement\n  changeEditMode: (id: Principal['id'], canEdit: Principal['canEdit']) => void\n  removeEntry: (id: Principal['id']) => void\n  createEntry: (name: Principal['name']) => void\n  editI18nKey: string\n  viewI18nKey: string\n  removeI18nKey: string\n  addI18nKey: string\n}\n\nexport enum EditMode {\n  VIEW,\n  EDIT\n}\n\nexport const PermissionList: React.FC<PermissionListProps> = ({ list, identifier, changeEditMode, removeEntry, createEntry, editI18nKey, viewI18nKey, removeI18nKey, addI18nKey }) => {\n  const { t } = useTranslation()\n  const [newEntry, setNewEntry] = useState('')\n\n  const addEntry = () => {\n    createEntry(newEntry)\n    setNewEntry('')\n  }\n\n  return (\n    <ul className={'list-group'}>\n      {list.map(entry => (\n        <li key={entry.id} className={'list-group-item d-flex flex-row justify-content-between align-items-center'}>\n          {identifier(entry)}\n          <div>\n            <Button\n              variant='light'\n              className={'text-danger mr-2'}\n              title={t(removeI18nKey, { name: entry.name })}\n              onClick={() => removeEntry(entry.id)}\n            >\n              <ForkAwesomeIcon icon={'times'}/>\n            </Button>\n            <ToggleButtonGroup\n              type='radio'\n              name='edit-mode'\n              value={entry.canEdit ? EditMode.EDIT : EditMode.VIEW}\n              onChange={(value: EditMode) => changeEditMode(entry.id, value === EditMode.EDIT)}\n            >\n              <ToggleButton\n                title={ t(viewI18nKey, { name: entry.name })}\n                variant={'light'}\n                className={'text-secondary'}\n                value={EditMode.VIEW}\n              >\n                <ForkAwesomeIcon icon='eye'/>\n              </ToggleButton>\n              <ToggleButton\n                title={t(editI18nKey, { name: entry.name })}\n                variant={'light'}\n                className={'text-secondary'}\n                value={EditMode.EDIT}\n              >\n                <ForkAwesomeIcon icon='pencil'/>\n              </ToggleButton>\n            </ToggleButtonGroup>\n          </div>\n        </li>\n      ))}\n      <li className={'list-group-item'}>\n        <form onSubmit={event => {\n          event.preventDefault()\n          addEntry()\n        }}>\n          <InputGroup className={'mr-1 mb-1'}>\n            <FormControl\n              value={newEntry}\n              placeholder={t(addI18nKey)}\n              aria-label={t(addI18nKey)}\n              onChange={event => setNewEntry(event.currentTarget.value)}\n            />\n            <Button\n              variant='light'\n              className={'text-secondary ml-2'}\n              title={t(addI18nKey)}\n              onClick={addEntry}\n            >\n              <ForkAwesomeIcon icon={'plus'}/>\n            </Button>\n          </InputGroup>\n        </form>\n      </li>\n    </ul>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react'\nimport { Form } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\n\nexport enum EditorPreferenceInputType {\n  SELECT,\n  BOOLEAN,\n  NUMBER\n}\n\nexport interface EditorPreferenceInputProps {\n  property: string\n  type: EditorPreferenceInputType\n  onChange: React.ChangeEventHandler<HTMLSelectElement>\n  value?: string | number | string[]\n}\n\nexport const EditorPreferenceInput: React.FC<EditorPreferenceInputProps> = ({ property, type, onChange, value, children }) => {\n  useTranslation()\n  return (\n    <Form.Group controlId={`editor-pref-${property}`}>\n      <Form.Label>\n        <Trans i18nKey={`editor.modal.preferences.${property}${type===EditorPreferenceInputType.NUMBER ? '' : '.label'}`}/>\n      </Form.Label>\n      <Form.Control\n        as={type === EditorPreferenceInputType.NUMBER ? 'input' : 'select'}\n        size='sm'\n        value={value}\n        onChange={onChange}\n        type={type === EditorPreferenceInputType.NUMBER ? 'number' : ''}>\n        {children}\n      </Form.Control>\n    </Form.Group>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { useEffect, useState } from 'react'\nimport { Alert, Modal } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { getUserById } from '../../../../api/users'\nimport { CommonModal } from '../../../common/modals/common-modal'\nimport { ShowIf } from '../../../common/show-if/show-if'\nimport { UserAvatar, UserAvatarProps } from '../../../common/user-avatar/user-avatar'\nimport { GroupMode, PermissionGroupEntry } from './permission-group-entry'\nimport { PermissionList } from './permission-list'\n\nexport interface PermissionsModalProps {\n  show: boolean,\n  onChangeShow: (newShow: boolean) => void\n}\n\nexport interface Principal {\n  id: string\n  name: string\n  photo: string\n  canEdit: boolean\n}\n\ninterface NotePermissions {\n  owner: string\n  sharedTo: {\n    username: string\n    canEdit: boolean\n  }[],\n  sharedToGroup: {\n    id: string\n    canEdit: boolean\n  }[]\n}\n\nexport const EVERYONE_GROUP_ID = '1'\nexport const EVERYONE_LOGGED_IN_GROUP_ID = '2'\n\nconst permissionsApiResponse: NotePermissions = {\n  owner: 'dermolly',\n  sharedTo: [{\n    username: 'emcrx',\n    canEdit: true\n  }, {\n    username: 'mrdrogdrog',\n    canEdit: false\n  }],\n  sharedToGroup: [{\n    id: EVERYONE_GROUP_ID,\n    canEdit: true\n  }, {\n    id: EVERYONE_LOGGED_IN_GROUP_ID,\n    canEdit: false\n  }]\n}\n\nexport const PermissionModal: React.FC<PermissionsModalProps> = ({ show, onChangeShow }) => {\n  useTranslation()\n  const [error, setError] = useState(false)\n  const [userList, setUserList] = useState<Principal[]>([])\n  const [owner, setOwner] = useState<UserAvatarProps>()\n  const [allUserPermissions, setAllUserPermissions] = useState(GroupMode.NONE)\n  const [allLoggedInUserPermissions, setAllLoggedInUserPermissions] = useState(GroupMode.NONE)\n\n  useEffect(() => {\n    // set owner\n    getUserById(permissionsApiResponse.owner).then(response => {\n      setOwner({\n        name: response.name,\n        photo: response.photo\n      })\n    }).catch(() => setError(true))\n    // set user List\n    permissionsApiResponse.sharedTo.forEach(shareUser => {\n      getUserById(shareUser.username).then(response => {\n        setUserList(list => list.concat([{\n          id: response.id,\n          name: response.name,\n          photo: response.photo,\n          canEdit: shareUser.canEdit\n        }]))\n      }).catch(() => setError(true))\n    })\n    // set group List\n    permissionsApiResponse.sharedToGroup.forEach(sharedGroup => {\n      if (sharedGroup.id === EVERYONE_GROUP_ID) {\n        setAllUserPermissions(sharedGroup.canEdit ? GroupMode.EDIT : GroupMode.VIEW)\n      } else if (sharedGroup.id === EVERYONE_LOGGED_IN_GROUP_ID) {\n        setAllLoggedInUserPermissions(sharedGroup.canEdit ? GroupMode.EDIT : GroupMode.VIEW)\n      }\n    })\n  }, [])\n\n  const changeUserMode = (userId: Principal['id'], canEdit: Principal['canEdit']) => {\n    setUserList(list =>\n      list\n        .map(user => {\n          if (user.id === userId) {\n            user.canEdit = canEdit\n          }\n          return user\n        }))\n  }\n\n  const removeUser = (userId: Principal['id']) => {\n    setUserList(list => list.filter(user => user.id !== userId))\n  }\n\n  const addUser = (name: Principal['name']) => {\n    setUserList(list => list.concat({\n      id: name,\n      photo: '/img/avatar.png',\n      name: name,\n      canEdit: false\n    }))\n  }\n\n  return (\n    <CommonModal\n      show={show}\n      onHide={() => onChangeShow(false)}\n      closeButton={true}\n      titleI18nKey={'editor.modal.permissions.title'}>\n      <Modal.Body>\n        <h5 className={'mb-3'}><Trans i18nKey={'editor.modal.permissions.owner'}/></h5>\n        <ShowIf condition={error}>\n          <Alert variant='danger'>\n            <Trans i18nKey='editor.modal.permissions.error'/>\n          </Alert>\n        </ShowIf>\n        <ul className={'list-group'}>\n          <li className={'list-group-item d-flex flex-row align-items-center'}>\n            <UserAvatar name={owner?.name ?? ''} photo={owner?.photo ?? ''}/>\n          </li>\n        </ul>\n        <h5 className={'my-3'}><Trans i18nKey={'editor.modal.permissions.sharedWithUsers'}/></h5>\n        <PermissionList\n          list={userList}\n          identifier={entry => (<UserAvatar name={entry.name} photo={entry.photo}/>)}\n          changeEditMode={changeUserMode}\n          removeEntry={removeUser}\n          createEntry={addUser}\n          editI18nKey={'editor.modal.permissions.editUser'}\n          viewI18nKey={'editor.modal.permissions.viewOnlyUser'}\n          removeI18nKey={'editor.modal.permissions.removeUser'}\n          addI18nKey={'editor.modal.permissions.addUser'}\n        />\n        <h5 className={'my-3'}><Trans i18nKey={'editor.modal.permissions.sharedWithGroups'}/></h5>\n        <ul className={'list-group'}>\n          <PermissionGroupEntry\n            title={'editor.modal.permissions.allUser'}\n            editMode={allUserPermissions}\n            onChangeEditMode={setAllUserPermissions}\n          />\n          <PermissionGroupEntry\n            title={'editor.modal.permissions.allLoggedInUser'}\n            editMode={allLoggedInUserPermissions}\n            onChangeEditMode={setAllLoggedInUserPermissions}\n          />\n        </ul>\n      </Modal.Body>\n    </CommonModal>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { Fragment, useState } from 'react'\nimport { TranslatedIconButton } from '../../../common/icon-button/translated-icon-button'\nimport { PermissionModal } from './permission-modal'\n\nexport const PermissionButton: React.FC = () => {\n  const [showPermissionModal, setShowPermissionModal] = useState(false)\n\n  return (\n    <Fragment>\n      <TranslatedIconButton size={'sm'} className={'mx-1'} icon={'lock'} variant={'light'} onClick={() => setShowPermissionModal(true)} i18nKey={'editor.documentBar.permissions'}/>\n      <PermissionModal show={showPermissionModal} onChangeShow={setShowPermissionModal}/>\n    </Fragment>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Cache } from '../../components/common/cache/cache'\nimport { defaultFetchConfig, expectResponseCode, getApiUrl } from '../utils'\nimport { Revision, RevisionListEntry } from './types'\n\nconst revisionCache = new Cache<string, Revision>(3600)\n\nexport const getRevision = async (noteId: string, timestamp: number): Promise<Revision> => {\n  const cacheKey = `${noteId}:${timestamp}`\n  if (revisionCache.has(cacheKey)) {\n    return revisionCache.get(cacheKey)\n  }\n  const response = await fetch(getApiUrl() + `/notes/${noteId}/revisions/${timestamp}`, {\n    ...defaultFetchConfig\n  })\n  expectResponseCode(response)\n  const revisionData = await response.json() as Revision\n  revisionCache.put(cacheKey, revisionData)\n  return revisionData\n}\n\nexport const getAllRevisions = async (noteId: string): Promise<RevisionListEntry[]> => {\n  // TODO Change 'revisions-list' to 'revisions' as soon as the backend is ready to serve some data!\n  const response = await fetch(getApiUrl() + `/notes/${noteId}/revisions-list`, {\n    ...defaultFetchConfig\n  })\n  expectResponseCode(response)\n  return await response.json() as Promise<RevisionListEntry[]>\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { DateTime } from 'luxon'\nimport React from 'react'\nimport { ListGroup } from 'react-bootstrap'\nimport { Trans } from 'react-i18next'\nimport { RevisionListEntry } from '../../../../api/revisions/types'\nimport { UserResponse } from '../../../../api/users/types'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\nimport { UserAvatar } from '../../../common/user-avatar/user-avatar'\n\nexport interface RevisionModalListEntryProps {\n  active: boolean\n  onClick: () => void\n  revision: RevisionListEntry\n  revisionAuthorListMap: Map<number, UserResponse[]>\n}\n\nexport const RevisionModalListEntry: React.FC<RevisionModalListEntryProps> = ({ active, onClick, revision, revisionAuthorListMap }) => (\n  <ListGroup.Item\n    as='li'\n    active={active}\n    onClick={onClick}\n    className='user-select-none revision-item d-flex flex-column'\n  >\n    <span>\n      <ForkAwesomeIcon icon={'clock-o'} className='mx-2'/>\n      {DateTime.fromMillis(revision.timestamp * 1000).toFormat('DDDD T')}\n    </span>\n    <span>\n      <ForkAwesomeIcon icon={'file-text-o'} className='mx-2'/>\n      <Trans i18nKey={'editor.modal.revision.length'}/>: {revision.length}\n    </span>\n    <span className={'d-flex flex-row my-1 align-items-center'}>\n      <ForkAwesomeIcon icon={'user-o'} className={'mx-2'}/>\n      {\n        revisionAuthorListMap.get(revision.timestamp)?.map((user, index) => {\n          return (\n            <UserAvatar name={user.name} photo={user.photo} showName={false} additionalClasses={'mx-1'} key={index}/>\n          )\n        })\n      }\n    </span>\n  </ListGroup.Item>\n)\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { useEffect, useRef, useState } from 'react'\nimport { Alert, Button, Col, ListGroup, Modal, Row } from 'react-bootstrap'\nimport ReactDiffViewer, { DiffMethod } from 'react-diff-viewer'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { useParams } from 'react-router'\nimport { getAllRevisions, getRevision } from '../../../../api/revisions'\nimport { Revision, RevisionListEntry } from '../../../../api/revisions/types'\nimport { UserResponse } from '../../../../api/users/types'\nimport { useIsDarkModeActivated } from '../../../../hooks/common/use-is-dark-mode-activated'\nimport { ApplicationState } from '../../../../redux'\nimport { CommonModal, CommonModalProps } from '../../../common/modals/common-modal'\nimport { ShowIf } from '../../../common/show-if/show-if'\nimport { RevisionModalListEntry } from './revision-modal-list-entry'\nimport './revision-modal.scss'\nimport { downloadRevision, getUserDataForRevision } from './utils'\n\nexport const RevisionModal: React.FC<CommonModalProps> = ({ show, onHide, icon, titleI18nKey }) => {\n  useTranslation()\n  const [revisions, setRevisions] = useState<RevisionListEntry[]>([])\n  const [selectedRevisionTimestamp, setSelectedRevisionTimestamp] = useState<number | null>(null)\n  const [selectedRevision, setSelectedRevision] = useState<Revision | null>(null)\n  const [error, setError] = useState(false)\n  const revisionAuthorListMap = useRef(new Map<number, UserResponse[]>())\n  const darkModeEnabled = useIsDarkModeActivated()\n  const { id } = useParams<{ id: string }>()\n\n  useEffect(() => {\n    getAllRevisions(id).then(fetchedRevisions => {\n      fetchedRevisions.forEach(revision => {\n        const authorData = getUserDataForRevision(revision.authors)\n        revisionAuthorListMap.current.set(revision.timestamp, authorData)\n      })\n      setRevisions(fetchedRevisions)\n      if (fetchedRevisions.length >= 1) {\n        setSelectedRevisionTimestamp(fetchedRevisions[0].timestamp)\n      }\n    }).catch(() => setError(true))\n  }, [setRevisions, setError, id])\n\n  useEffect(() => {\n    if (selectedRevisionTimestamp === null) {\n      return\n    }\n    getRevision(id, selectedRevisionTimestamp).then(fetchedRevision => {\n      setSelectedRevision(fetchedRevision)\n    }).catch(() => setError(true))\n  }, [selectedRevisionTimestamp, id])\n\n  const markdownContent = useSelector((state: ApplicationState) => state.documentContent.content)\n\n  return (\n    <CommonModal show={show} onHide={onHide} titleI18nKey={titleI18nKey} icon={icon} closeButton={true} size={'xl'} additionalClasses='revision-modal'>\n      <Modal.Body>\n        <Row>\n          <Col lg={4} className={'scroll-col'}>\n            <ListGroup as='ul'>\n              {\n                revisions.map((revision, revisionIndex) => (\n                  <RevisionModalListEntry\n                    key={revisionIndex}\n                    active={selectedRevisionTimestamp === revision.timestamp}\n                    revision={revision}\n                    revisionAuthorListMap={revisionAuthorListMap.current}\n                    onClick={() => setSelectedRevisionTimestamp(revision.timestamp)}\n                  />\n                ))\n              }\n            </ListGroup>\n          </Col>\n          <Col lg={8} className={'scroll-col'}>\n            <ShowIf condition={error}>\n              <Alert variant='danger'>\n                <Trans i18nKey='editor.modal.revision.error'/>\n              </Alert>\n            </ShowIf>\n            <ShowIf condition={!error && !!selectedRevision}>\n              <ReactDiffViewer\n                oldValue={selectedRevision?.content}\n                newValue={markdownContent}\n                splitView={false}\n                compareMethod={DiffMethod.WORDS}\n                useDarkTheme={darkModeEnabled}\n              />\n            </ShowIf>\n          </Col>\n        </Row>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button\n          variant='secondary'\n          onClick={onHide}>\n          <Trans i18nKey={'common.close'}/>\n        </Button>\n        <Button\n          variant='danger'\n          disabled={!selectedRevisionTimestamp}\n          onClick={() => window.alert('Not yet implemented. Requires websocket.')}>\n          <Trans i18nKey={'editor.modal.revision.revertButton'}/>\n        </Button>\n        <Button\n          variant='primary'\n          disabled={!selectedRevisionTimestamp}\n          onClick={() => downloadRevision(id, selectedRevision)}>\n          <Trans i18nKey={'editor.modal.revision.download'}/>\n        </Button>\n      </Modal.Footer>\n    </CommonModal>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Revision } from '../../../../api/revisions/types'\nimport { getUserById } from '../../../../api/users'\nimport { UserResponse } from '../../../../api/users/types'\nimport { download } from '../../../common/download/download'\n\nexport const downloadRevision = (noteId: string, revision: Revision | null): void => {\n  if (!revision) {\n    return\n  }\n  download(revision.content, `${noteId}-${revision.timestamp}.md`, 'text/markdown')\n}\n\nexport const getUserDataForRevision = (authors: string[]): UserResponse[] => {\n  const users: UserResponse[] = []\n  authors.forEach((author, index) => {\n    if (index > 9) {\n      return\n    }\n    getUserById(author)\n      .then(userData => {\n        users.push(userData)\n      })\n      .catch((error) => console.error(error))\n  })\n  return users\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { Fragment, useState } from 'react'\nimport { TranslatedIconButton } from '../../../common/icon-button/translated-icon-button'\nimport { RevisionModal } from './revision-modal'\n\nexport const RevisionButton: React.FC = () => {\n  const [show, setShow] = useState(false)\n\n  return (\n    <Fragment>\n      <TranslatedIconButton size={'sm'} className={'mx-1'} icon={'history'} variant={'light'} i18nKey={'editor.documentBar.revision'} onClick={() => setShow(true)}/>\n      <RevisionModal show={show} onHide={() => setShow(false)} titleI18nKey={'editor.modal.revision.title'} icon={'history'}/>\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { PinToHistoryButton } from './buttons/pin-to-history-button'\nimport { ShareLinkButton } from './buttons/share-link-button'\nimport { ConnectionIndicator } from './connection-indicator/connection-indicator'\nimport { DocumentInfoButton } from './document-info/document-info-button'\nimport { EditorMenu } from './menus/editor-menu'\nimport { ExportMenu } from './menus/export-menu'\nimport { ImportMenu } from './menus/import-menu'\nimport { PermissionButton } from './permissions/permission-button'\nimport { RevisionButton } from './revisions/revision-button'\n\nexport interface DocumentBarProps {\n  title: string\n}\n\nexport const DocumentBar: React.FC<DocumentBarProps> = ({ title }) => {\n  useTranslation()\n\n  return (\n    <div className={'navbar navbar-expand navbar-light bg-light'}>\n      <div className=\"navbar-nav\">\n        <ShareLinkButton/>\n        <DocumentInfoButton/>\n        <RevisionButton/>\n        <PinToHistoryButton/>\n        <PermissionButton/>\n      </div>\n      <div className=\"ml-auto navbar-nav\">\n        <ImportMenu/>\n        <ExportMenu title={title}/>\n        <EditorMenu noteTitle={title}/>\n        <ConnectionIndicator/>\n      </div>\n    </div>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { useMemo, useRef, useState } from 'react'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../redux'\nimport { LineMarkerPosition } from '../../markdown-renderer/types'\nimport { useScrollToLineMark } from '../scroll/hooks/use-scroll-to-line-mark'\nimport { useUserScroll } from '../scroll/hooks/use-user-scroll'\nimport { ScrollProps } from '../scroll/scroll-props'\nimport { DocumentRenderPane, DocumentRenderPaneProps } from './document-render-pane'\n\nexport const ScrollingDocumentRenderPane: React.FC<DocumentRenderPaneProps & ScrollProps> = ({\n  scrollState,\n  wide,\n  onFirstHeadingChange,\n  onMakeScrollSource,\n  onMetadataChange,\n  onScroll,\n  onTaskCheckedChange\n}) => {\n  const markdownContent = useSelector((state: ApplicationState) => state.documentContent.content)\n  const renderer = useRef<HTMLDivElement>(null)\n  const [lineMarks, setLineMarks] = useState<LineMarkerPosition[]>()\n\n  const contentLineCount = useMemo(() => markdownContent.split('\\n').length, [markdownContent])\n  useScrollToLineMark(scrollState, lineMarks, contentLineCount, renderer)\n  const userScroll = useUserScroll(lineMarks, renderer, onScroll)\n\n  return (\n    <DocumentRenderPane\n      extraClasses={'overflow-y-scroll'}\n      documentRenderPaneRef={renderer}\n      wide={wide}\n      onFirstHeadingChange={onFirstHeadingChange}\n      onLineMarkerPositionChanged={setLineMarks}\n      onMetadataChange={onMetadataChange}\n      onMouseEnterRenderer={onMakeScrollSource}\n      onScrollRenderer={userScroll}\n      onTaskCheckedChange={onTaskCheckedChange}\n    />\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { RefObject, useCallback, useEffect, useRef } from 'react'\nimport { LineMarkerPosition } from '../../../markdown-renderer/types'\nimport { ScrollState } from '../scroll-props'\nimport { findLineMarks } from '../utils'\n\nexport const useScrollToLineMark = (scrollState: ScrollState | undefined, lineMarks: LineMarkerPosition[] | undefined, contentLineCount: number, renderer: RefObject<HTMLElement>): void => {\n  const lastScrollPosition = useRef<number>()\n\n  const scrollTo = useCallback((targetPosition: number): void => {\n    if (!renderer.current || targetPosition === lastScrollPosition.current) {\n      return\n    }\n    lastScrollPosition.current = targetPosition\n    renderer.current.scrollTo({\n      top: targetPosition\n    })\n  }, [renderer])\n\n  useEffect(() => {\n    if (!renderer.current || !lineMarks || lineMarks.length === 0 || !scrollState) {\n      return\n    }\n    if (scrollState.firstLineInView < lineMarks[0].line) {\n      scrollTo(0)\n      return\n    }\n    if (scrollState.firstLineInView > lineMarks[lineMarks.length - 1].line) {\n      scrollTo(renderer.current.offsetHeight)\n      return\n    }\n    const { lastMarkBefore, firstMarkAfter } = findLineMarks(lineMarks, scrollState.firstLineInView)\n    const positionBefore = lastMarkBefore ? lastMarkBefore.position : lineMarks[0].position\n    const positionAfter = firstMarkAfter ? firstMarkAfter.position : renderer.current.offsetHeight\n    const lastMarkBeforeLine = lastMarkBefore ? lastMarkBefore.line : 1\n    const firstMarkAfterLine = firstMarkAfter ? firstMarkAfter.line : contentLineCount\n    const linesBetweenMarkers = firstMarkAfterLine - lastMarkBeforeLine\n    const blockHeight = positionAfter - positionBefore\n    const lineHeight = blockHeight / linesBetweenMarkers\n    const position = positionBefore + (scrollState.firstLineInView - lastMarkBeforeLine) * lineHeight + scrollState.scrolledPercentage / 100 * lineHeight\n    const correctedPosition = Math.floor(position)\n    scrollTo(correctedPosition)\n  }, [contentLineCount, lineMarks, renderer, scrollState, scrollTo])\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { LineMarkerPosition } from '../../markdown-renderer/types'\n\nexport const findLineMarks = (lineMarks: LineMarkerPosition[], lineNumber: number): { lastMarkBefore: LineMarkerPosition | undefined, firstMarkAfter: LineMarkerPosition | undefined } => {\n  let lastMarkBefore\n  let firstMarkAfter\n  for (let i = 0; i < lineMarks.length; i++) {\n    const currentMark = lineMarks[i]\n    if (!currentMark) {\n      continue\n    }\n\n    if (currentMark.line <= lineNumber) {\n      lastMarkBefore = currentMark\n    }\n    if (currentMark.line > lineNumber) {\n      firstMarkAfter = currentMark\n    }\n    if (!!firstMarkAfter && !!lastMarkBefore) {\n      break\n    }\n  }\n  return {\n    lastMarkBefore,\n    firstMarkAfter\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { RefObject, useCallback } from 'react'\nimport { LineMarkerPosition } from '../../../markdown-renderer/types'\nimport { ScrollState } from '../scroll-props'\n\nexport const useUserScroll = (lineMarks: LineMarkerPosition[] | undefined, renderer: RefObject<HTMLElement>, onScroll: ((newScrollState: ScrollState) => void)|undefined): () => void =>\n  useCallback(() => {\n    if (!renderer.current || !lineMarks || lineMarks.length === 0 || !onScroll) {\n      return\n    }\n\n    const scrollTop = renderer.current.scrollTop\n\n    const lineMarksBeforeScrollTop = lineMarks.filter(lineMark => lineMark.position <= scrollTop)\n    if (lineMarksBeforeScrollTop.length === 0) {\n      return\n    }\n\n    const lineMarksAfterScrollTop = lineMarks.filter(lineMark => lineMark.position > scrollTop)\n    if (lineMarksAfterScrollTop.length === 0) {\n      return\n    }\n\n    const beforeLineMark = lineMarksBeforeScrollTop\n      .reduce((prevLineMark, currentLineMark) =>\n        prevLineMark.line >= currentLineMark.line ? prevLineMark : currentLineMark)\n\n    const afterLineMark = lineMarksAfterScrollTop\n      .reduce((prevLineMark, currentLineMark) =>\n        prevLineMark.line < currentLineMark.line ? prevLineMark : currentLineMark)\n\n    const componentHeight = afterLineMark.position - beforeLineMark.position\n    const distanceToBefore = scrollTop - beforeLineMark.position\n    const percentageRaw = (distanceToBefore / componentHeight)\n    const lineCount = afterLineMark.line - beforeLineMark.line\n    const line = Math.floor(lineCount * percentageRaw + beforeLineMark.line)\n    const lineHeight = componentHeight / lineCount\n    const innerScrolling = Math.floor((distanceToBefore % lineHeight) / lineHeight * 100)\n\n    const newScrollState: ScrollState = { firstLineInView: line, scrolledPercentage: innerScrolling }\n    onScroll(newScrollState)\n  }, [lineMarks, onScroll, renderer])\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport { Button, Modal } from 'react-bootstrap'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { CommonModal } from '../../common/modals/common-modal'\n\nexport interface MaxLengthWarningModalProps {\n  show: boolean\n  onHide: () => void\n  maxLength: number\n}\n\nexport const MaxLengthWarningModal: React.FC<MaxLengthWarningModalProps> = ({ show, onHide, maxLength }) => {\n  useTranslation()\n\n  return (\n    <CommonModal data-cy={'limitReachedModal'} show={show} onHide={onHide} titleI18nKey={'editor.error.limitReached.title'} closeButton={true}>\n      <Modal.Body>\n        <Trans i18nKey={'editor.error.limitReached.description'} values={{ maxLength }} />\n        <strong className='mt-2 d-block'><Trans i18nKey={'editor.error.limitReached.advice'}/></strong>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button onClick={onHide}><Trans i18nKey={'common.close'}/></Button>\n      </Modal.Footer>\n    </CommonModal>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { findWordAtCursor, Hinter, search } from './index'\n\nconst wordRegExp = /^```((\\w|-|_|\\+)*)$/\nlet allSupportedLanguages: string[] = []\n\nconst codeBlockHint = (editor: Editor): Promise< Hints| null > => {\n  return import(/* webpackChunkName: \"highlight.js\" */ '../../../common/hljs/hljs').then((hljs) =>\n    new Promise((resolve) => {\n      const searchTerm = findWordAtCursor(editor)\n      const searchResult = wordRegExp.exec(searchTerm.text)\n      if (searchResult === null) {\n        resolve(null)\n        return\n      }\n      const term = searchResult[1]\n      if (allSupportedLanguages.length === 0) {\n        allSupportedLanguages = hljs.default.listLanguages().concat('csv', 'flow', 'html', 'js', 'markmap', 'abc', 'graphviz', 'mermaid', 'vega-lite')\n      }\n      const suggestions = search(term, allSupportedLanguages)\n      const cursor = editor.getCursor()\n      if (!suggestions) {\n        resolve(null)\n      } else {\n        resolve({\n          list: suggestions.map((suggestion: string): Hint => ({\n            text: '```' + suggestion + '\\n\\n```\\n',\n            displayText: suggestion\n          })),\n          from: Pos(cursor.line, searchTerm.start),\n          to: Pos(cursor.line, searchTerm.end)\n        })\n      }\n    }))\n}\n\nexport const CodeBlockHinter: Hinter = {\n  wordRegExp,\n  hint: codeBlockHint\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { findWordAtCursor, Hinter } from './index'\n\nconst wordRegExp = /^(<d(?:e|et|eta|etai|etail|etails)?)$/\n\nconst collapsableBlockHint = (editor: Editor): Promise< Hints| null > => {\n  return new Promise((resolve) => {\n    const searchTerm = findWordAtCursor(editor)\n    const searchResult = wordRegExp.exec(searchTerm.text)\n    if (searchResult === null) {\n      resolve(null)\n      return\n    }\n    const suggestions = ['<details>\\n  <summary>Toggle label</summary>\\n  Toggled content\\n</details>']\n    const cursor = editor.getCursor()\n    if (!suggestions) {\n      resolve(null)\n    } else {\n      resolve({\n        list: suggestions.map((suggestion: string): Hint => ({\n          text: suggestion\n        })),\n        from: Pos(cursor.line, searchTerm.start),\n        to: Pos(cursor.line, searchTerm.end + 1)\n      })\n    }\n  })\n}\n\nexport const CollapsableBlockHinter: Hinter = {\n  wordRegExp,\n  hint: collapsableBlockHint\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { validAlertLevels } from '../../../markdown-renderer/markdown-it-plugins/alert-container'\nimport { findWordAtCursor, Hinter } from './index'\n\nconst wordRegExp = /^:::((\\w|-|_|\\+)*)$/\nconst spoilerSuggestion: Hint = {\n  text: ':::spoiler Toggle label\\nToggled content\\n::: \\n',\n  displayText: 'spoiler'\n}\nconst suggestions = validAlertLevels.map((suggestion: string): Hint => ({\n  text: ':::' + suggestion + '\\n\\n::: \\n',\n  displayText: suggestion\n})).concat(spoilerSuggestion)\n\nconst containerHint = (editor: Editor): Promise<Hints | null> => {\n  return new Promise((resolve) => {\n    const searchTerm = findWordAtCursor(editor)\n    const searchResult = wordRegExp.exec(searchTerm.text)\n    if (searchResult === null) {\n      resolve(null)\n      return\n    }\n    const cursor = editor.getCursor()\n    if (!suggestions) {\n      resolve(null)\n    } else {\n      resolve({\n        list: suggestions.filter((suggestion) => suggestion.displayText?.startsWith(searchResult[1])),\n        from: Pos(cursor.line, searchTerm.start),\n        to: Pos(cursor.line, searchTerm.end)\n      })\n    }\n  })\n}\n\nexport const ContainerHinter: Hinter = {\n  wordRegExp,\n  hint: containerHint\n}\n","export default __webpack_public_path__ + \"static/media/forkawesome.da7d0f53.png\";","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { Picker } from 'emoji-picker-element'\nimport { CustomEmoji, EmojiClickEvent, EmojiClickEventDetail } from 'emoji-picker-element/shared'\nimport React, { useEffect, useRef } from 'react'\nimport { useClickAway } from 'react-use'\nimport { useIsDarkModeActivated } from '../../../../../hooks/common/use-is-dark-mode-activated'\nimport './emoji-picker.scss'\nimport forkawesomeIcon from './forkawesome.png'\nimport { ForkAwesomeIcons } from './icon-names'\n\nexport interface EmojiPickerProps {\n  show: boolean\n  onEmojiSelected: (emoji: EmojiClickEventDetail) => void\n  onDismiss: () => void\n}\n\nexport const customEmojis: CustomEmoji[] = Object.keys(ForkAwesomeIcons).map((name) => ({\n  name: `fa-${name}`,\n  shortcodes: [`fa-${name.toLowerCase()}`],\n  url: forkawesomeIcon,\n  category: 'ForkAwesome'\n}))\n\nexport const EMOJI_DATA_PATH = '/static/js/emoji-data.json'\n\nexport const emojiPickerConfig = {\n  customEmoji: customEmojis,\n  dataSource: EMOJI_DATA_PATH\n}\n\nconst twemojiStyle = (): HTMLStyleElement => {\n  const style = document.createElement('style')\n  style.textContent = 'section.picker { --font-family: \"Twemoji Mozilla\" !important; }'\n  return style\n}\n\nexport const EmojiPicker: React.FC<EmojiPickerProps> = ({ show, onEmojiSelected, onDismiss }) => {\n  const darkModeEnabled = useIsDarkModeActivated()\n  const pickerContainerRef = useRef<HTMLDivElement>(null)\n  const pickerRef = useRef<Picker>()\n\n  useClickAway(pickerContainerRef, () => {\n    onDismiss()\n  })\n\n  useEffect(() => {\n    if (!pickerContainerRef.current) {\n      return\n    }\n    const picker = new Picker(emojiPickerConfig)\n    if (picker.shadowRoot) {\n      picker.shadowRoot.appendChild(twemojiStyle())\n    }\n    pickerContainerRef.current.appendChild(picker)\n\n    pickerRef.current = picker\n    return () => {\n      picker.remove()\n      pickerRef.current = undefined\n    }\n  }, [])\n\n  useEffect(() => {\n    if (!pickerRef.current) {\n      return\n    }\n    const emojiClick = (event: EmojiClickEvent): void => {\n      onEmojiSelected(event.detail)\n    }\n    const picker = pickerRef.current\n    picker.addEventListener('emoji-click', emojiClick, true)\n    return () => {\n      picker.removeEventListener('emoji-click', emojiClick, true)\n    }\n  }, [onEmojiSelected])\n\n  useEffect(() => {\n    if (!pickerRef.current) {\n      return\n    }\n    pickerRef.current.setAttribute('class', darkModeEnabled ? 'dark' : 'light')\n    if (darkModeEnabled) {\n      pickerRef.current.removeAttribute('style')\n    } else {\n      pickerRef.current.setAttribute('style', '--background: #f8f9fa')\n    }\n  }, [darkModeEnabled])\n\n  return (\n    <div className={`position-absolute emoji-picker-container ${!show ? 'd-none' : ''}`} ref={pickerContainerRef}/>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { EmojiClickEventDetail, NativeEmoji } from 'emoji-picker-element/shared'\n\nexport const getEmojiIcon = (emoji: EmojiClickEventDetail): string => {\n  if (emoji.unicode) {\n    return emoji.unicode\n  }\n  if (emoji.name) {\n    // noinspection CheckTagEmptyBody\n    return `<i class=\"fa ${emoji.name}\"></i>`\n  }\n  return ''\n}\n\nexport const getEmojiShortCode = (emoji: EmojiClickEventDetail): string|undefined => {\n  if (!emoji.emoji.shortcodes) {\n    return undefined\n  }\n  let skinToneModifier = ''\n  if ((emoji.emoji as NativeEmoji).skins && emoji.skinTone !== 0) {\n    skinToneModifier = `:skin-tone-${emoji.skinTone as number}:`\n  }\n  return `:${emoji.emoji.shortcodes[0]}:${skinToneModifier}`\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport Database from 'emoji-picker-element/database'\nimport { Emoji, EmojiClickEventDetail, NativeEmoji } from 'emoji-picker-element/shared'\nimport { emojiPickerConfig } from '../tool-bar/emoji-picker/emoji-picker'\nimport { getEmojiIcon, getEmojiShortCode } from '../tool-bar/utils/emojiUtils'\nimport { findWordAtCursor, Hinter } from './index'\n\nconst emojiIndex = new Database(emojiPickerConfig)\nconst emojiWordRegex = /^:([\\w-_+]*)$/\n\nconst findEmojiInDatabase = async (emojiIndex: Database, term: string): Promise<Emoji[]> => {\n  try {\n    if (term === '') {\n      return await emojiIndex.getTopFavoriteEmoji(7)\n    }\n    const queryResult = await emojiIndex.getEmojiBySearchQuery(term)\n    if (queryResult.length === 0) {\n      return await emojiIndex.getTopFavoriteEmoji(7)\n    } else {\n      return queryResult\n    }\n  } catch (error) {\n    console.error(error)\n    return []\n  }\n}\n\nconst convertEmojiEventToHint = (emojiData:EmojiClickEventDetail): Hint | undefined => {\n  const shortCode = getEmojiShortCode(emojiData)\n  if (!shortCode) {\n    return undefined\n  }\n  return {\n    text: shortCode,\n    render: (parent: HTMLLIElement) => {\n      const wrapper = document.createElement('div')\n      wrapper.innerHTML = `${getEmojiIcon(emojiData)}   ${shortCode}`\n      parent.appendChild(wrapper)\n    }\n  }\n}\n\nconst generateEmojiHints = async (editor: Editor): Promise<Hints | null> => {\n  const searchTerm = findWordAtCursor(editor)\n  const searchResult = emojiWordRegex.exec(searchTerm.text)\n  if (searchResult === null) {\n    return null\n  }\n  const suggestionList: Emoji[] = await findEmojiInDatabase(emojiIndex, searchResult[1])\n  const cursor = editor.getCursor()\n  const skinTone = await emojiIndex.getPreferredSkinTone()\n  const emojiEventDetails: EmojiClickEventDetail[] = suggestionList\n    .filter(emoji => !!emoji.shortcodes)\n    .map((emoji) => ({\n      emoji,\n      skinTone: skinTone,\n      unicode: ((emoji as NativeEmoji).unicode ? (emoji as NativeEmoji).unicode : undefined),\n      name: emoji.name\n    }))\n\n  const hints = emojiEventDetails\n    .map(convertEmojiEventToHint)\n    .filter(o => !!o) as Hint[]\n  return {\n    list: hints,\n    from: Pos(cursor.line, searchTerm.start),\n    to: Pos(cursor.line, searchTerm.end)\n  }\n}\n\nexport const EmojiHinter: Hinter = {\n  wordRegExp: emojiWordRegex,\n  hint: generateEmojiHints\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { findWordAtCursor, Hinter, search } from './index'\n\nconst wordRegExp = /^(\\s{0,3})(#{1,6})$/\nconst allSupportedHeaders = ['# h1', '## h2', '### h3', '#### h4', '##### h5', '###### h6', '###### tags: `example`']\nconst allSupportedHeadersTextToInsert = ['# ', '## ', '### ', '#### ', '##### ', '###### ', '###### tags: `example`']\n\nconst headerHint = (editor: Editor): Promise< Hints| null > => {\n  return new Promise((resolve) => {\n    const searchTerm = findWordAtCursor(editor)\n    const searchResult = wordRegExp.exec(searchTerm.text)\n    if (searchResult === null) {\n      resolve(null)\n      return\n    }\n    const term = searchResult[0]\n    if (!term) {\n      resolve(null)\n      return\n    }\n    const suggestions = search(term, allSupportedHeaders)\n    const cursor = editor.getCursor()\n    if (!suggestions) {\n      resolve(null)\n    } else {\n      resolve({\n        list: suggestions.map((suggestion): Hint => ({\n          text: allSupportedHeadersTextToInsert[allSupportedHeaders.indexOf(suggestion)],\n          displayText: suggestion\n        })),\n        from: Pos(cursor.line, searchTerm.start),\n        to: Pos(cursor.line, searchTerm.end)\n      })\n    }\n  })\n}\n\nexport const HeaderHinter: Hinter = {\n  wordRegExp,\n  hint: headerHint\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { findWordAtCursor, Hinter } from './index'\n\nconst wordRegExp = /^(!(\\[.*])?)$/\nconst allSupportedImages = [\n  '![image alt](https:// \"title\")',\n  '![image alt](https:// \"title\" =WidthxHeight)',\n  '![image alt][reference]'\n]\n\nconst imageHint = (editor: Editor): Promise< Hints| null > => {\n  return new Promise((resolve) => {\n    const searchTerm = findWordAtCursor(editor)\n    const searchResult = wordRegExp.exec(searchTerm.text)\n    if (searchResult === null) {\n      resolve(null)\n      return\n    }\n    const suggestions = allSupportedImages\n    const cursor = editor.getCursor()\n    if (!suggestions) {\n      resolve(null)\n    } else {\n      resolve({\n        list: suggestions.map((suggestion: string): Hint => ({\n          text: suggestion\n        })),\n        from: Pos(cursor.line, searchTerm.start),\n        to: Pos(cursor.line, searchTerm.end + 1)\n      })\n    }\n  })\n}\n\nexport const ImageHinter: Hinter = {\n  wordRegExp,\n  hint: imageHint\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { DateTime } from 'luxon'\nimport { getUser } from '../../../../redux/user/methods'\nimport { findWordAtCursor, Hinter } from './index'\n\nconst wordRegExp = /^(\\[(.*])?)$/\nconst allSupportedLinks = [\n  '[link text](https:// \"title\")',\n  '[reference]: https:// \"title\"',\n  '[link text][reference]',\n  '[reference]',\n  '[^footnote reference]: https://',\n  '[^footnote reference]',\n  '^[inline footnote]',\n  '[TOC]',\n  'name',\n  'time',\n  '[color=#FFFFFF]'\n\n]\n\nconst linkAndExtraTagHint = (editor: Editor): Promise< Hints| null > => {\n  return new Promise((resolve) => {\n    const searchTerm = findWordAtCursor(editor)\n    const searchResult = wordRegExp.exec(searchTerm.text)\n    if (searchResult === null) {\n      resolve(null)\n      return\n    }\n    const suggestions = allSupportedLinks\n    const cursor = editor.getCursor()\n    if (!suggestions) {\n      resolve(null)\n    } else {\n      resolve({\n        list: suggestions.map((suggestion: string): Hint => {\n          const user = getUser()\n          const userName = user ? user.name : 'Anonymous'\n          switch (suggestion) {\n            case 'name':\n              // Get the user when a completion happens, this prevents to early calls resulting in 'Anonymous'\n              return {\n                text: `[name=${userName}]`\n              }\n            case 'time':\n              // show the current time when the autocompletion is opened and not when the function is loaded\n              return {\n                text: `[time=${DateTime.local().toFormat('DDDD T')}]`\n              }\n            default:\n              return {\n                text: suggestion + ' ',\n                displayText: suggestion\n              }\n          }\n        }),\n        from: Pos(cursor.line, searchTerm.start),\n        to: Pos(cursor.line, searchTerm.end + 1)\n      })\n    }\n  })\n}\n\nexport const LinkAndExtraTagHinter: Hinter = {\n  wordRegExp,\n  hint: linkAndExtraTagHint\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hint, Hints, Pos } from 'codemirror'\nimport { findWordAtCursor, Hinter } from './index'\n\nconst wordRegExp = /^({[%}]?)$/\n\nconst pdfHint = (editor: Editor): Promise< Hints| null > => {\n  return new Promise((resolve) => {\n    const searchTerm = findWordAtCursor(editor)\n    const searchResult = wordRegExp.exec(searchTerm.text)\n    if (searchResult === null) {\n      resolve(null)\n      return\n    }\n    const suggestions = ['{%pdf https:// %}']\n    const cursor = editor.getCursor()\n    if (!suggestions) {\n      resolve(null)\n    } else {\n      resolve({\n        list: suggestions.map((suggestion: string): Hint => ({\n          text: suggestion\n        })),\n        from: Pos(cursor.line, searchTerm.start),\n        to: Pos(cursor.line, searchTerm.end + 1)\n      })\n    }\n  })\n}\n\nexport const PDFHinter: Hinter = {\n  wordRegExp,\n  hint: pdfHint\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor, Hints } from 'codemirror'\nimport { CodeBlockHinter } from './code-block'\nimport { CollapsableBlockHinter } from './collapsable-block'\nimport { ContainerHinter } from './container'\nimport { EmojiHinter } from './emoji'\nimport { HeaderHinter } from './header'\nimport { ImageHinter } from './image'\nimport { LinkAndExtraTagHinter } from './link-and-extra-tag'\nimport { PDFHinter } from './pdf'\n\ninterface findWordAtCursorResponse {\n  start: number,\n  end: number,\n  text: string\n}\n\nexport interface Hinter {\n  wordRegExp: RegExp,\n  hint: (editor: Editor) => Promise< Hints| null >\n}\n\nconst allowedChars = /[^\\s]/\n\nexport const findWordAtCursor = (editor: Editor): findWordAtCursorResponse => {\n  const cursor = editor.getCursor()\n  const line = editor.getLine(cursor.line)\n  let start = cursor.ch\n  let end = cursor.ch\n  while (start && allowedChars.test(line.charAt(start - 1))) {\n    --start\n  }\n  while (end < line.length && allowedChars.test(line.charAt(end))) {\n    ++end\n  }\n\n  return {\n    text: line.slice(start, end).toLowerCase(),\n    start: start,\n    end: end\n  }\n}\n\nexport const search = (term: string, list: string[]): string[] => {\n  const suggestions: string[] = []\n  list.forEach(item => {\n    if (item.toLowerCase().startsWith(term.toLowerCase())) {\n      suggestions.push(item)\n    }\n  })\n  return suggestions.slice(0, 7)\n}\n\nexport const allHinters: Hinter[] = [\n  CodeBlockHinter,\n  ContainerHinter,\n  EmojiHinter,\n  HeaderHinter,\n  ImageHinter,\n  LinkAndExtraTagHinter,\n  PDFHinter,\n  CollapsableBlockHinter,\n]\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nexport const createNumberRangeArray = (length: number) : number[] => {\n  return Array.from(Array(length).keys())\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor } from 'codemirror'\nimport { EmojiClickEventDetail } from 'emoji-picker-element/shared'\nimport { createNumberRangeArray } from '../../../../common/number-range/number-range'\nimport { getEmojiShortCode } from './emojiUtils'\n\nexport const makeSelectionBold = (editor: Editor): void => wrapTextWith(editor, '**')\nexport const makeSelectionItalic = (editor: Editor): void => wrapTextWith(editor, '*')\nexport const strikeThroughSelection = (editor: Editor): void => wrapTextWith(editor, '~~')\nexport const underlineSelection = (editor: Editor): void => wrapTextWith(editor, '++')\nexport const subscriptSelection = (editor: Editor): void => wrapTextWith(editor, '~')\nexport const superscriptSelection = (editor: Editor): void => wrapTextWith(editor, '^')\nexport const markSelection = (editor: Editor): void => wrapTextWith(editor, '==')\n\nexport const addHeaderLevel = (editor: Editor): void => changeLines(editor, line => line.startsWith('#') ? `#${line}` : `# ${line}`)\nexport const addCodeFences = (editor: Editor): void => wrapTextWithOrJustPut(editor, '```\\n', '\\n```')\nexport const addQuotes = (editor: Editor): void => insertOnStartOfLines(editor, '> ')\n\nexport const addList = (editor: Editor): void => createList(editor, () => '- ')\nexport const addOrderedList = (editor: Editor): void => createList(editor, j => `${j}. `)\nexport const addTaskList = (editor: Editor): void => createList(editor, () => '- [ ] ')\n\nexport const addImage = (editor: Editor): void => addLink(editor, '!')\n\nexport const addLine = (editor: Editor): void => changeLines(editor, line => `${line}\\n----`)\nexport const addCollapsableBlock = (editor: Editor): void => changeLines(editor, line => `${line}\\n:::spoiler Toggle label\\n  Toggled content\\n:::`)\nexport const addComment = (editor: Editor): void => changeLines(editor, line => `${line}\\n> []`)\nexport const addTable = (editor: Editor, rows: number, columns: number): void => {\n  const rowArray = createNumberRangeArray(rows)\n  const colArray = createNumberRangeArray(columns).map(col => col + 1)\n  const head = '|  # ' + colArray.join(' |  # ') + ' |'\n  const divider = '| ' + colArray.map(() => '----').join(' | ') + ' |'\n  const body = rowArray.map(() => '| ' + colArray.map(() => 'Text').join(' | ') + ' |').join('\\n')\n  const table = `${head}\\n${divider}\\n${body}`\n  changeLines(editor, line => `${line}\\n${table}`)\n}\n\nexport const addEmoji = (emoji: EmojiClickEventDetail, editor: Editor): void => {\n  const shortCode = getEmojiShortCode(emoji)\n  if (shortCode) {\n    insertAtCursor(editor, shortCode)\n  }\n}\n\nexport const wrapTextWith = (editor: Editor, symbol: string, endSymbol?: string): void => {\n  if (!editor.getSelection()) {\n    return\n  }\n  const ranges = editor.listSelections()\n  for (const range of ranges) {\n    if (range.empty()) {\n      continue\n    }\n    const from = range.from()\n    const to = range.to()\n\n    const selection = editor.getRange(from, to)\n    editor.replaceRange(symbol + selection + (endSymbol || symbol), from, to, '+input')\n    range.head.ch += symbol.length\n    range.anchor.ch += endSymbol ? endSymbol.length : symbol.length\n  }\n  editor.setSelections(ranges)\n}\n\nconst wrapTextWithOrJustPut = (editor: Editor, symbol: string, endSymbol?: string): void => {\n  if (!editor.getSelection()) {\n    const cursor = editor.getCursor()\n    const lineNumber = cursor.line\n    const line = editor.getLine(lineNumber)\n    const replacement = /\\s*\\\\n/.exec(line) ? `${symbol}${endSymbol ?? ''}` : `${symbol}${line}${endSymbol ?? ''}`\n    editor.replaceRange(replacement,\n      { line: cursor.line, ch: 0 },\n      { line: cursor.line, ch: line.length },\n      '+input')\n  }\n  wrapTextWith(editor, symbol, endSymbol ?? symbol)\n}\n\nexport const insertOnStartOfLines = (editor: Editor, symbol: string): void => {\n  const cursor = editor.getCursor()\n  const ranges = editor.listSelections()\n  for (const range of ranges) {\n    const from = range.empty() ? { line: cursor.line, ch: 0 } : range.from()\n    const to = range.empty() ? { line: cursor.line, ch: editor.getLine(cursor.line).length } : range.to()\n    const selection = editor.getRange(from, to)\n    const lines = selection.split('\\n')\n    editor.replaceRange(lines.map(line => `${symbol}${line}`).join('\\n'), from, to, '+input')\n  }\n  editor.setSelections(ranges)\n}\n\nexport const changeLines = (editor: Editor, replaceFunction: (line: string) => string): void => {\n  const cursor = editor.getCursor()\n  const ranges = editor.listSelections()\n  for (const range of ranges) {\n    const lineNumber = range.empty() ? cursor.line : range.from().line\n    const line = editor.getLine(lineNumber)\n    editor.replaceRange(replaceFunction(line), { line: lineNumber, ch: 0 }, {\n      line: lineNumber,\n      ch: line.length\n    }, '+input')\n  }\n  editor.setSelections(ranges)\n}\n\nexport const createList = (editor: Editor, listMark: (i: number) => string): void => {\n  const cursor = editor.getCursor()\n  const ranges = editor.listSelections()\n  for (const range of ranges) {\n    const from = range.empty() ? { line: cursor.line, ch: 0 } : range.from()\n    const to = range.empty() ? { line: cursor.line, ch: editor.getLine(cursor.line).length } : range.to()\n\n    const selection = editor.getRange(from, to)\n    const lines = selection.split('\\n')\n    editor.replaceRange(lines.map((line, i) => `${listMark(i + 1)}${line}`).join('\\n'), from, to, '+input')\n  }\n  editor.setSelections(ranges)\n}\n\nexport const addLink = (editor: Editor, prefix?: string): void => {\n  const cursor = editor.getCursor()\n  const ranges = editor.listSelections()\n  for (const range of ranges) {\n    const from = range.empty() ? { line: cursor.line, ch: cursor.ch } : range.from()\n    const to = range.empty() ? { line: cursor.line, ch: cursor.ch } : range.to()\n    const selection = editor.getRange(from, to)\n    const linkRegex = /^(?:https?|ftp|mailto):/\n    if (linkRegex.exec(selection)) {\n      editor.replaceRange(`${prefix || ''}[](${selection})`, from, to, '+input')\n    } else {\n      editor.replaceRange(`${prefix || ''}[${selection}](https://)`, from, to, '+input')\n    }\n  }\n}\n\nexport const insertAtCursor = (editor: Editor, text: string): void => {\n  const cursor = editor.getCursor()\n  const ranges = editor.listSelections()\n  for (const range of ranges) {\n    const from = range.empty() ? { line: cursor.line, ch: cursor.ch } : range.from()\n    const to = range.empty() ? { line: cursor.line, ch: cursor.ch } : range.to()\n    editor.replaceRange(`${text}`, from, to, '+input')\n  }\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport CodeMirror, { Editor, KeyMap, Pass } from 'codemirror'\nimport { isMac } from '../utils'\nimport {\n  addLink,\n  makeSelectionBold,\n  makeSelectionItalic,\n  markSelection,\n  strikeThroughSelection,\n  underlineSelection\n} from './tool-bar/utils/toolbarButtonUtils'\n\nconst isVim = (keyMapName?: string) => (keyMapName?.substr(0, 3) === 'vim')\n\nconst f10 = (editor: Editor): void | typeof Pass => editor.setOption('fullScreen', !editor.getOption('fullScreen'))\nconst esc = (editor: Editor): void | typeof Pass => {\n  if (editor.getOption('fullScreen') && !isVim(editor.getOption('keyMap'))) {\n    editor.setOption('fullScreen', false)\n  } else {\n    return CodeMirror.Pass\n  }\n}\nconst suppressKey = (): undefined => undefined\nconst tab = (editor: Editor) => {\n  const tab = '\\t'\n\n  // contruct x length spaces\n  const spaces = Array((editor.getOption('indentUnit') ?? 0) + 1).join(' ')\n\n  // auto indent whole line when in list or blockquote\n  const cursor = editor.getCursor()\n  const line = editor.getLine(cursor.line)\n\n  // this regex match the following patterns\n  // 1. blockquote starts with \"> \" or \">>\"\n  // 2. unorder list starts with *+-parseInt\n  // 3. order list starts with \"1.\" or \"1)\"\n  const regex = /^(\\s*)(>[> ]*|[*+-]\\s|(\\d+)([.)]))/\n\n  let match\n  const multiple = editor.getSelection().split('\\n').length > 1 ||\n    editor.getSelections().length > 1\n\n  if (multiple) {\n    editor.execCommand('defaultTab')\n  } else if ((match = regex.exec(line)) !== null) {\n    const ch = match[1].length\n    const pos = {\n      line: cursor.line,\n      ch: ch\n    }\n    if (editor.getOption('indentWithTabs')) {\n      editor.replaceRange(tab, pos, pos, '+input')\n    } else {\n      editor.replaceRange(spaces, pos, pos, '+input')\n    }\n  } else {\n    if (editor.getOption('indentWithTabs')) {\n      editor.execCommand('defaultTab')\n    } else {\n      editor.replaceSelection(spaces)\n    }\n  }\n}\n\nexport const defaultKeyMap: KeyMap = !isMac\n  ? {\n      F9: suppressKey,\n      F10: f10,\n      Esc: esc,\n      'Ctrl-S': suppressKey,\n      Enter: 'newlineAndIndentContinueMarkdownList',\n      Tab: tab,\n      Home: 'goLineLeftSmart',\n      End: 'goLineRight',\n      'Ctrl-I': makeSelectionItalic,\n      'Ctrl-B': makeSelectionBold,\n      'Ctrl-U': underlineSelection,\n      'Ctrl-D': strikeThroughSelection,\n      'Ctrl-M': markSelection,\n      'Ctrl-K': addLink\n    }\n  : {\n      F9: suppressKey,\n      F10: f10,\n      Esc: esc,\n      'Cmd-S': suppressKey,\n      Enter: 'newlineAndIndentContinueMarkdownList',\n      Tab: tab,\n      'Cmd-Left': 'goLineLeftSmart',\n      'Cmd-Right': 'goLineRight',\n      Home: 'goLineLeftSmart',\n      End: 'goLineRight',\n      'Cmd-I': makeSelectionItalic,\n      'Cmd-B': makeSelectionBold,\n      'Cmd-U': underlineSelection,\n      'Cmd-D': strikeThroughSelection,\n      'Cmd-M': markSelection\n    }\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { Editor, Position } from 'codemirror'\nimport React, { useMemo } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { ShowIf } from '../../../common/show-if/show-if'\nimport './status-bar.scss'\n\nexport interface StatusBarInfo {\n  position: Position\n  selectedColumns: number\n  selectedLines: number\n  linesInDocument: number\n  charactersInDocument: number\n  remainingCharacters: number\n}\n\nexport const defaultState: StatusBarInfo = {\n  position: { line: 0, ch: 0 },\n  selectedColumns: 0,\n  selectedLines: 0,\n  linesInDocument: 0,\n  charactersInDocument: 0,\n  remainingCharacters: 0\n}\n\nexport const createStatusInfo = (editor: Editor, maxDocumentLength: number): StatusBarInfo => ({\n  position: editor.getCursor(),\n  charactersInDocument: editor.getValue().length,\n  remainingCharacters: maxDocumentLength - editor.getValue().length,\n  linesInDocument: editor.lineCount(),\n  selectedColumns: editor.getSelection().length,\n  selectedLines: editor.getSelection().split('\\n').length\n})\n\nexport const StatusBar: React.FC<StatusBarInfo> = ({ position, selectedColumns, selectedLines, charactersInDocument, linesInDocument, remainingCharacters }) => {\n  const { t } = useTranslation()\n\n  const getLengthTooltip = useMemo(() => {\n    if (remainingCharacters === 0) {\n      return t('editor.statusBar.lengthTooltip.maximumReached')\n    }\n    if (remainingCharacters < 0) {\n      return t('editor.statusBar.lengthTooltip.exceeded', { exceeded: -remainingCharacters })\n    }\n    return t('editor.statusBar.lengthTooltip.remaining', { remaining: remainingCharacters })\n  }, [remainingCharacters, t])\n\n  return (\n    <div className=\"d-flex flex-row status-bar px-2\">\n      <div>\n        <span>{t('editor.statusBar.cursor', { line: position.line + 1, columns: position.ch + 1 })}</span>\n        <ShowIf condition={selectedColumns !== 0 && selectedLines !== 0}>\n          <ShowIf condition={selectedLines === 1}>\n            <span>&nbsp;&nbsp;{t('editor.statusBar.selection.column', { count: selectedColumns })}</span>\n          </ShowIf>\n          <ShowIf condition={selectedLines > 1}>\n            <span>&nbsp;&nbsp;{t('editor.statusBar.selection.line', { count: selectedLines })}</span>\n          </ShowIf>\n        </ShowIf>\n      </div>\n      <div className=\"ml-auto\">\n        <span>{t('editor.statusBar.lines', { lines: linesInDocument })}</span>\n        &nbsp;&nbsp;\n        <span\n          data-cy={'remainingCharacters'}\n          title={getLengthTooltip}\n          className={remainingCharacters <= 0 ? 'text-danger' : remainingCharacters <= 100 ? 'text-warning' : ''}\n        >\n          {t('editor.statusBar.length', { length: charactersInDocument })}\n        </span>\n      </div>\n    </div>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nexport const supportedMimeTypes: string[] = [\n  'application/pdf',\n  'image/apng',\n  'image/bmp',\n  'image/gif',\n  'image/heif',\n  'image/heic',\n  'image/heif-sequence',\n  'image/heic-sequence',\n  'image/jpeg',\n  'image/png',\n  'image/svg+xml',\n  'image/tiff',\n  'image/webp'\n]\n\nexport const supportedMimeTypesJoined = supportedMimeTypes.join(', ')\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { Editor } from 'codemirror'\nimport i18n from 'i18next'\nimport { uploadFile } from '../../../api/media'\nimport { store } from '../../../redux'\nimport { supportedMimeTypes } from './tool-bar/utils/upload-image-mimetypes'\n\nexport const handleUpload = (file: File, editor: Editor): void => {\n  if (!file) {\n    return\n  }\n  const mimeType = file.type\n  if (!supportedMimeTypes.includes(mimeType)) {\n    // this mimetype is not supported\n    return\n  }\n  const cursor = editor.getCursor()\n  const uploadPlaceholder = `![${i18n.t('editor.upload.uploadFile', { fileName: file.name })}]()`\n  const noteId = store.getState().documentContent.noteId\n  editor.replaceRange(uploadPlaceholder, cursor, cursor, '+input')\n  uploadFile(noteId, mimeType, file)\n    .then(({ link }) => {\n      editor.replaceRange(getCorrectSyntaxForLink(mimeType, link), cursor, {\n        line: cursor.line,\n        ch: cursor.ch + uploadPlaceholder.length\n      }, '+input')\n    })\n    .catch(() => {\n      editor.replaceRange('', cursor, {\n        line: cursor.line,\n        ch: cursor.ch + uploadPlaceholder.length\n      }, '+input')\n    })\n}\n\nconst getCorrectSyntaxForLink = (mimeType: string, link: string): string => {\n  switch (mimeType) {\n    case 'application/pdf':\n      return `{%pdf ${link} %}`\n    default:\n      return `![](${link})`\n  }\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nexport enum EditorPreferenceProperty {\n  KEYMAP = 'keyMap',\n  THEME = 'theme',\n  INDENT_WITH_TABS = 'indentWithTabs',\n  INDENT_UNIT = 'indentUnit',\n  SPELL_CHECK = 'spellcheck'\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { EditorConfiguration } from 'codemirror'\nimport equal from \"fast-deep-equal\"\nimport React, { ChangeEvent, useCallback } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../../redux'\nimport { mergeEditorPreferences } from '../../../../../redux/editor/methods'\nimport { EditorPreferenceInput, EditorPreferenceInputType } from './editor-preference-input'\nimport { EditorPreferenceProperty } from './editor-preference-property'\n\nexport interface EditorPreferenceBooleanProps {\n  property: EditorPreferenceProperty\n}\n\nexport const EditorPreferenceBooleanProperty: React.FC<EditorPreferenceBooleanProps> = ({ property }) => {\n  const preference = useSelector((state: ApplicationState) => state.editorConfig.preferences[property]?.toString() || '', equal)\n\n  const { t } = useTranslation()\n  const selectItem = useCallback((event: ChangeEvent<HTMLSelectElement>) => {\n    const selectedItem: boolean = event.target.value === 'true'\n\n    mergeEditorPreferences({\n      [property]: selectedItem\n    } as EditorConfiguration)\n  }, [property])\n\n  const i18nPrefix = `editor.modal.preferences.${property}`\n\n  return (\n    <EditorPreferenceInput onChange={selectItem} property={property} type={EditorPreferenceInputType.SELECT} value={preference}>\n      <option value={'true'}>\n        {t(`${i18nPrefix}.on`)}\n      </option>\n      <option value={'false'}>\n        {t(`${i18nPrefix}.off`)}\n      </option>\n    </EditorPreferenceInput>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ChangeEvent, useCallback } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../../redux'\nimport { setEditorLigatures } from '../../../../../redux/editor/methods'\nimport { EditorPreferenceInput, EditorPreferenceInputType } from './editor-preference-input'\n\nexport const EditorPreferenceLigaturesSelect: React.FC = () => {\n  const ligaturesEnabled = useSelector((state: ApplicationState) => Boolean(state.editorConfig.ligatures).toString())\n  const saveLigatures = useCallback((event: ChangeEvent<HTMLSelectElement>) => {\n    const ligaturesActivated: boolean = event.target.value === 'true'\n    setEditorLigatures(ligaturesActivated)\n  }, [])\n  const { t } = useTranslation()\n\n  return (\n    <EditorPreferenceInput onChange={saveLigatures} value={ligaturesEnabled} property={\"ligatures\"}\n                           type={EditorPreferenceInputType.BOOLEAN}>\n      <option value='true'>{t(`common.yes`)}</option>\n      <option value='false'>{t(`common.no`)}</option>\n    </EditorPreferenceInput>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { EditorConfiguration } from 'codemirror'\nimport equal from \"fast-deep-equal\"\nimport React, { ChangeEvent, useCallback } from 'react'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../../redux'\nimport { mergeEditorPreferences } from '../../../../../redux/editor/methods'\nimport { EditorPreferenceInput, EditorPreferenceInputType } from './editor-preference-input'\nimport { EditorPreferenceProperty } from './editor-preference-property'\n\nexport interface EditorPreferenceNumberProps {\n  property: EditorPreferenceProperty\n}\n\nexport const EditorPreferenceNumberProperty: React.FC<EditorPreferenceNumberProps> = ({ property }) => {\n  const preference = useSelector((state: ApplicationState) => state.editorConfig.preferences[property]?.toString() || '', equal)\n\n  const selectItem = useCallback((event: ChangeEvent<HTMLSelectElement>) => {\n    const selectedItem: number = Number.parseInt(event.target.value)\n\n    mergeEditorPreferences({\n      [property]: selectedItem\n    } as EditorConfiguration)\n  }, [property])\n\n  return (\n    <EditorPreferenceInput onChange={selectItem} property={property} type={EditorPreferenceInputType.NUMBER} value={preference}/>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { EditorConfiguration } from 'codemirror'\nimport equal from \"fast-deep-equal\"\nimport React, { ChangeEvent, useCallback } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../../redux'\nimport { mergeEditorPreferences } from '../../../../../redux/editor/methods'\nimport { EditorPreferenceInput, EditorPreferenceInputType } from './editor-preference-input'\nimport { EditorPreferenceProperty } from './editor-preference-property'\n\nexport interface EditorPreferenceSelectPropertyProps {\n  property: EditorPreferenceProperty\n  selections: string[]\n}\n\nexport const EditorPreferenceSelectProperty: React.FC<EditorPreferenceSelectPropertyProps> = ({ property, selections }) => {\n  const preference = useSelector((state: ApplicationState) => state.editorConfig.preferences[property]?.toString() || '', equal)\n\n  const { t } = useTranslation()\n\n  const selectItem = useCallback((event: ChangeEvent<HTMLSelectElement>) => {\n    const selectedItem: string = event.target.value\n\n    mergeEditorPreferences({\n      [property]: selectedItem\n    } as EditorConfiguration)\n  }, [property])\n\n  const i18nPrefix = `editor.modal.preferences.${property}`\n\n  return (\n    <EditorPreferenceInput onChange={selectItem} property={property} type={EditorPreferenceInputType.SELECT} value={preference}>\n      {selections.map(selection =>\n        <option key={selection} value={selection}>\n          {t(`${i18nPrefix}.${selection}`) }\n        </option>)}\n    </EditorPreferenceInput>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { Fragment, useCallback, useEffect, useRef, useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { useLocation, useParams } from 'react-router'\nimport useMedia from 'use-media'\nimport { useApplyDarkMode } from '../../hooks/common/use-apply-dark-mode'\nimport { useDocumentTitle } from '../../hooks/common/use-document-title'\nimport { ApplicationState } from '../../redux'\nimport { setDocumentContent, setDocumentMetadata, setNoteId } from '../../redux/document-content/methods'\nimport { setEditorMode } from '../../redux/editor/methods'\nimport { extractNoteTitle } from '../common/document-title/note-title-extractor'\nimport { MotdBanner } from '../common/motd-banner/motd-banner'\nimport { AppBar, AppBarMode } from './app-bar/app-bar'\nimport { EditorMode } from './app-bar/editor-view-mode'\nimport { DocumentBar } from './document-bar/document-bar'\nimport { ScrollingDocumentRenderPane } from './document-renderer-pane/scrolling-document-render-pane'\nimport { EditorPane } from './editor-pane/editor-pane'\nimport { editorTestContent } from './editorTestContent'\nimport { useViewModeShortcuts } from './hooks/useViewModeShortcuts'\nimport { DualScrollState, ScrollState } from './scroll/scroll-props'\nimport { Splitter } from './splitter/splitter'\nimport { YAMLMetaData } from './yaml-metadata/yaml-metadata'\n\nexport interface EditorPathParams {\n  id: string\n}\n\nexport enum ScrollSource {\n  EDITOR,\n  RENDERER\n}\n\nconst TASK_REGEX = /(\\s*[-*] )(\\[[ xX]])( .*)/\n\nexport const Editor: React.FC = () => {\n  const { t } = useTranslation()\n  const { id } = useParams<EditorPathParams>()\n  const { search } = useLocation()\n  const untitledNote = t('editor.untitledNote')\n  const markdownContent = useSelector((state: ApplicationState) => state.documentContent.content)\n  const isWide = useMedia({ minWidth: 576 }, true)\n  const [documentTitle, setDocumentTitle] = useState(untitledNote)\n  const noteMetadata = useRef<YAMLMetaData>()\n  const firstHeading = useRef<string>()\n  const scrollSource = useRef<ScrollSource>(ScrollSource.EDITOR)\n\n  const editorMode: EditorMode = useSelector((state: ApplicationState) => state.editorConfig.editorMode)\n  const editorSyncScroll: boolean = useSelector((state: ApplicationState) => state.editorConfig.syncScroll)\n\n  const [scrollState, setScrollState] = useState<DualScrollState>(() => ({\n    editorScrollState: { firstLineInView: 1, scrolledPercentage: 0 },\n    rendererScrollState: { firstLineInView: 1, scrolledPercentage: 0 }\n  }))\n\n  useEffect(() => {\n    setDocumentContent(editorTestContent)\n    const requestedMode = search.substr(1)\n    const mode = Object.values(EditorMode).find(mode => mode === requestedMode)\n    if (mode) {\n      setEditorMode(mode)\n    }\n  }, [search])\n\n  const updateDocumentTitle = useCallback(() => {\n    const noteTitle = extractNoteTitle(untitledNote, noteMetadata.current, firstHeading.current)\n    setDocumentTitle(noteTitle)\n  }, [noteMetadata, firstHeading, untitledNote])\n\n  const onFirstHeadingChange = useCallback((newFirstHeading: string | undefined) => {\n    firstHeading.current = newFirstHeading\n    updateDocumentTitle()\n  }, [updateDocumentTitle])\n\n  const onMetadataChange = useCallback((metaData: YAMLMetaData | undefined) => {\n    noteMetadata.current = metaData\n    setDocumentMetadata(metaData)\n    updateDocumentTitle()\n  }, [updateDocumentTitle])\n\n  const onTaskCheckedChange = useCallback((lineInMarkdown: number, checked: boolean) => {\n    const lines = markdownContent.split('\\n')\n    const results = TASK_REGEX.exec(lines[lineInMarkdown])\n    if (results) {\n      const before = results[1]\n      const after = results[3]\n      lines[lineInMarkdown] = `${before}[${checked ? 'x' : ' '}]${after}`\n      setDocumentContent(lines.join('\\n'))\n    }\n  }, [markdownContent])\n\n  useViewModeShortcuts()\n\n  useEffect(() => {\n    setNoteId(id)\n  }, [id])\n\n  useEffect(() => {\n    if (!isWide && editorMode === EditorMode.BOTH) {\n      setEditorMode(EditorMode.PREVIEW)\n    }\n  }, [editorMode, isWide])\n\n  const onMarkdownRendererScroll = useCallback((newScrollState: ScrollState) => {\n    if (scrollSource.current === ScrollSource.RENDERER && editorSyncScroll) {\n      setScrollState((old) => ({ editorScrollState: newScrollState, rendererScrollState: old.rendererScrollState }))\n    }\n  }, [editorSyncScroll])\n\n  const onEditorScroll = useCallback((newScrollState: ScrollState) => {\n    if (scrollSource.current === ScrollSource.EDITOR && editorSyncScroll) {\n      setScrollState((old) => ({ rendererScrollState: newScrollState, editorScrollState: old.editorScrollState }))\n    }\n  }, [editorSyncScroll])\n\n  useApplyDarkMode()\n  useDocumentTitle(documentTitle)\n\n  return (\n    <Fragment>\n      <MotdBanner/>\n      <div className={'d-flex flex-column vh-100'}>\n        <AppBar mode={AppBarMode.EDITOR}/>\n        <DocumentBar title={documentTitle}/>\n        <Splitter\n          showLeft={editorMode === EditorMode.EDITOR || editorMode === EditorMode.BOTH}\n          left={\n            <EditorPane\n              onContentChange={setDocumentContent}\n              content={markdownContent}\n              scrollState={scrollState.editorScrollState}\n              onScroll={onEditorScroll}\n              onMakeScrollSource={() => (scrollSource.current = ScrollSource.EDITOR)}\n            />\n          }\n          showRight={editorMode === EditorMode.PREVIEW || (editorMode === EditorMode.BOTH)}\n          right={\n            <ScrollingDocumentRenderPane\n              onFirstHeadingChange={onFirstHeadingChange}\n              onMakeScrollSource={() => {\n                scrollSource.current = ScrollSource.RENDERER\n              }}\n              onMetadataChange={onMetadataChange}\n              onScroll={onMarkdownRendererScroll}\n              onTaskCheckedChange={onTaskCheckedChange}\n              scrollState={scrollState.rendererScrollState}\n              wide={editorMode === EditorMode.PREVIEW}\n            />\n          }\n          containerClassName={'overflow-hidden'}/>\n      </div>\n    </Fragment>\n  )\n}\n\nexport default Editor\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport equal from \"fast-deep-equal\"\nimport React, { Fragment, useState } from 'react'\nimport { Button, Form, ListGroup } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../../../redux'\nimport { ForkAwesomeIcon } from '../../../../common/fork-awesome/fork-awesome-icon'\nimport { CommonModal } from '../../../../common/modals/common-modal'\nimport { ShowIf } from '../../../../common/show-if/show-if'\nimport { EditorPreferenceBooleanProperty } from './editor-preference-boolean-property'\nimport { EditorPreferenceInput, EditorPreferenceInputType } from './editor-preference-input'\nimport { EditorPreferenceLigaturesSelect } from './editor-preference-ligatures-select'\nimport { EditorPreferenceNumberProperty } from './editor-preference-number-property'\nimport { EditorPreferenceProperty } from \"./editor-preference-property\"\nimport { EditorPreferenceSelectProperty } from \"./editor-preference-select-property\"\n\nexport const EditorPreferences: React.FC = () => {\n  const { t } = useTranslation()\n  const [showModal, setShowModal] = useState(false)\n  const indentWithTabs = useSelector((state: ApplicationState) => state.editorConfig.preferences.indentWithTabs ?? false, equal)\n\n  return (\n    <Fragment>\n      <Button variant='light' onClick={() => setShowModal(true)} title={t('editor.editorToolbar.preferences')}>\n        <ForkAwesomeIcon icon=\"wrench\"/>\n      </Button>\n      <CommonModal\n        show={showModal}\n        onHide={() => setShowModal(false)}\n        titleI18nKey={'editor.modal.preferences.title'}\n        closeButton={true}\n        icon={'wrench'}>\n        <Form>\n          <ListGroup>\n            <ListGroup.Item>\n              <EditorPreferenceSelectProperty property={EditorPreferenceProperty.THEME} selections={['one-dark', 'neat']}/>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <EditorPreferenceSelectProperty property={EditorPreferenceProperty.KEYMAP} selections={['sublime', 'emacs', 'vim']}/>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <EditorPreferenceBooleanProperty property={EditorPreferenceProperty.INDENT_WITH_TABS}/>\n            </ListGroup.Item>\n            <ShowIf condition={!indentWithTabs}>\n              <ListGroup.Item>\n                <EditorPreferenceNumberProperty property={EditorPreferenceProperty.INDENT_UNIT}/>\n              </ListGroup.Item>\n            </ShowIf>\n            <ListGroup.Item>\n              <EditorPreferenceLigaturesSelect/>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <EditorPreferenceInput onChange={() => alert('This feature is not yet implemented.')} property={EditorPreferenceProperty.SPELL_CHECK} type={EditorPreferenceInputType.SELECT}>\n                <option value='off'>Off</option>\n                <option value='en'>English</option>\n              </EditorPreferenceInput>\n            </ListGroup.Item>\n          </ListGroup>\n        </Form>\n      </CommonModal>\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport CodeMirror from 'codemirror'\nimport React, { Fragment, useState } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../../../../common/fork-awesome/fork-awesome-icon'\nimport { addEmoji } from '../utils/toolbarButtonUtils'\nimport { EmojiPicker } from './emoji-picker'\n\nexport interface EmojiPickerButtonProps {\n  editor: CodeMirror.Editor\n}\n\nexport const EmojiPickerButton: React.FC<EmojiPickerButtonProps> = ({ editor }) => {\n  const { t } = useTranslation()\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false)\n\n  return (\n    <Fragment>\n      <EmojiPicker\n        show={showEmojiPicker}\n        onEmojiSelected={(emoji) => {\n          setShowEmojiPicker(false)\n          addEmoji(emoji, editor)\n        }}\n        onDismiss={() => setShowEmojiPicker(false)}/>\n      <Button data-cy={'show-emoji-picker'} variant='light' onClick={() => setShowEmojiPicker(old => !old)} title={t('editor.editorToolbar.emoji')}>\n        <ForkAwesomeIcon icon=\"smile-o\"/>\n      </Button>\n    </Fragment>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { useCallback, useEffect, useState } from 'react'\nimport { Button, Form, ModalFooter } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../../../../common/fork-awesome/fork-awesome-icon'\nimport { CommonModal } from '../../../../common/modals/common-modal'\nimport { TableSize } from './table-picker'\n\nexport interface CustomTableSizeModalProps {\n  showModal: boolean\n  onDismiss: () => void\n  onTablePicked: (row: number, cols: number) => void\n}\n\nexport const CustomTableSizeModal: React.FC<CustomTableSizeModalProps> = ({ showModal, onDismiss, onTablePicked }) => {\n  const { t } = useTranslation()\n  const [tableSize, setTableSize] = useState<TableSize>({\n    rows: 0,\n    columns: 0\n  })\n\n  useEffect(() => {\n    setTableSize({\n      rows: 0,\n      columns: 0\n    })\n  }, [showModal])\n\n  const onClick = useCallback(() => {\n    onTablePicked(tableSize.rows, tableSize.columns)\n    onDismiss()\n  }, [onDismiss, tableSize, onTablePicked])\n\n  return (\n    <CommonModal\n      show={showModal}\n      onHide={() => onDismiss()}\n      titleI18nKey={'editor.editorToolbar.table.customSize'}\n      closeButton={true}\n      icon={'table'}>\n      <div className={'col-lg-10 d-flex flex-row p-3 align-items-center'}>\n        <Form.Control\n          type={'number'}\n          min={1}\n          placeholder={t('editor.editorToolbar.table.cols')}\n          isInvalid={tableSize.columns <= 0}\n          onChange={(event) => {\n            const value = Number.parseInt(event.currentTarget.value)\n            setTableSize(old => ({\n              rows: old.rows,\n              columns: isNaN(value) ? 0 : value\n            }))\n          }}\n        />\n        <ForkAwesomeIcon icon='times' className='mx-2' fixedWidth={true}/>\n        <Form.Control\n          type={'number'}\n          min={1}\n          placeholder={t('editor.editorToolbar.table.rows')}\n          isInvalid={tableSize.rows <= 0}\n          onChange={(event) => {\n            const value = Number.parseInt(event.currentTarget.value)\n            setTableSize(old => ({\n              rows: isNaN(value) ? 0 : value,\n              columns: old.columns\n            }))\n          }}/>\n      </div>\n      <ModalFooter>\n        <Button onClick={onClick} disabled={tableSize.rows <= 0 || tableSize.columns <= 0}>\n          {t('editor.editorToolbar.table.create')}\n        </Button>\n      </ModalFooter>\n    </CommonModal>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { useClickAway } from 'react-use'\nimport { ForkAwesomeIcon } from '../../../../common/fork-awesome/fork-awesome-icon'\nimport { createNumberRangeArray } from '../../../../common/number-range/number-range'\nimport { CustomTableSizeModal } from './custom-table-size-modal'\nimport './table-picker.scss'\n\nexport interface TablePickerProps {\n  show: boolean\n  onDismiss: () => void\n  onTablePicked: (row: number, cols: number) => void\n}\n\nexport type TableSize = {\n  rows: number,\n  columns: number\n}\n\nexport const TablePicker: React.FC<TablePickerProps> = ({ show, onDismiss, onTablePicked }) => {\n  const { t } = useTranslation()\n  const containerRef = useRef<HTMLDivElement>(null)\n  const [tableSize, setTableSize] = useState<TableSize>()\n  const [showDialog, setShowDialog] = useState(false)\n\n  useClickAway(containerRef, () => {\n    onDismiss()\n  })\n\n  useEffect(() => {\n    setTableSize(undefined)\n  }, [show])\n\n  const onClick = useCallback(() => {\n    if (tableSize) {\n      onTablePicked(tableSize.rows, tableSize.columns)\n    }\n  }, [onTablePicked, tableSize])\n\n  return (\n    <div className={`position-absolute table-picker-container p-2 ${!show || showDialog ? 'd-none' : ''} bg-light`} ref={containerRef} role=\"grid\">\n      <p className={'lead'}>\n        { tableSize\n          ? t('editor.editorToolbar.table.size', { cols: tableSize?.columns, rows: tableSize.rows })\n          : t('editor.editorToolbar.table.title')\n        }\n      </p>\n      <div className={'table-container'}>\n        {createNumberRangeArray(8).map((row: number) => (\n          createNumberRangeArray(10).map((col: number) => (\n            <div\n              key={`${row}_${col}`}\n              className={`table-cell ${tableSize && row < tableSize.rows && col < tableSize.columns ? 'bg-primary' : ''}`}\n              onMouseEnter={() => {\n                setTableSize({\n                  rows: row + 1,\n                  columns: col + 1\n                })\n              }}\n              title={t('editor.editorToolbar.table.size', { cols: col + 1, rows: row + 1 })}\n              onClick={onClick}\n            />\n          )\n          )\n        ))}\n      </div>\n      <div className=\"d-flex justify-content-center mt-2\">\n        <Button data-cy={'show-custom-table-modal'} className={'text-center'} onClick={() => setShowDialog(true)}>\n          <ForkAwesomeIcon icon=\"table\"/>&nbsp;{t('editor.editorToolbar.table.customSize')}\n        </Button>\n        <CustomTableSizeModal\n          showModal={showDialog}\n          onDismiss={() => setShowDialog(false)}\n          onTablePicked={onTablePicked}\n        />\n      </div>\n    </div>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport CodeMirror from 'codemirror'\nimport React, { Fragment, useState } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../../../../common/fork-awesome/fork-awesome-icon'\nimport { addTable } from '../utils/toolbarButtonUtils'\nimport { TablePicker } from './table-picker'\n\nexport interface TablePickerButtonProps {\n  editor: CodeMirror.Editor\n}\n\nexport const TablePickerButton: React.FC<TablePickerButtonProps> = ({ editor }) => {\n  const { t } = useTranslation()\n  const [showTablePicker, setShowTablePicker] = useState(false)\n\n  return (\n    <Fragment>\n      <TablePicker\n        show={showTablePicker}\n        onDismiss={() => setShowTablePicker(false)}\n        onTablePicked={(rows, cols) => {\n          setShowTablePicker(false)\n          addTable(editor, rows, cols)\n        }}\n      />\n      <Button data-cy={'show-table-overlay'} variant='light' onClick={() => setShowTablePicker(old => !old)} title={t('editor.editorToolbar.table.title')}>\n        <ForkAwesomeIcon icon=\"table\"/>\n      </Button>\n    </Fragment>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { Editor } from 'codemirror'\nimport React, { useCallback } from 'react'\nimport { Button, ButtonGroup, ButtonToolbar } from 'react-bootstrap'\nimport { useTranslation } from 'react-i18next'\nimport { ForkAwesomeIcon } from '../../../common/fork-awesome/fork-awesome-icon'\nimport { HiddenInputMenuEntry } from '../../../common/hidden-input-menu-entry/hidden-input-menu-entry'\nimport { handleUpload } from '../upload-handler'\nimport { EditorPreferences } from './editor-preferences/editor-preferences'\nimport { EmojiPickerButton } from './emoji-picker/emoji-picker-button'\nimport { TablePickerButton } from './table-picker/table-picker-button'\nimport './tool-bar.scss'\nimport {\n  addCodeFences,\n  addCollapsableBlock,\n  addComment,\n  addHeaderLevel,\n  addImage,\n  addLine,\n  addLink,\n  addList,\n  addOrderedList,\n  addQuotes,\n  addTaskList,\n  makeSelectionBold,\n  makeSelectionItalic,\n  strikeThroughSelection,\n  subscriptSelection,\n  superscriptSelection,\n  underlineSelection\n} from './utils/toolbarButtonUtils'\nimport { supportedMimeTypesJoined } from './utils/upload-image-mimetypes'\n\nexport interface ToolBarProps {\n  editor: Editor | undefined\n}\n\nexport const ToolBar: React.FC<ToolBarProps> = ({ editor }) => {\n  const { t } = useTranslation()\n\n  const onUploadImage = useCallback((file: File) => {\n    if (editor) {\n      handleUpload(file, editor)\n    }\n    return Promise.resolve()\n  }, [editor])\n\n  if (!editor) {\n    return null\n  }\n\n  return (\n    <ButtonToolbar className='bg-light'>\n      <ButtonGroup className={'mx-1 flex-wrap'}>\n        <Button data-cy={'format-bold'} variant='light' onClick={() => makeSelectionBold(editor)} title={t('editor.editorToolbar.bold')}>\n          <ForkAwesomeIcon icon=\"bold\"/>\n        </Button>\n        <Button data-cy={'format-italic'} variant='light' onClick={() => makeSelectionItalic(editor)} title={t('editor.editorToolbar.italic')}>\n          <ForkAwesomeIcon icon=\"italic\"/>\n        </Button>\n        <Button data-cy={'format-underline'} variant='light' onClick={() => underlineSelection(editor)} title={t('editor.editorToolbar.underline')}>\n          <ForkAwesomeIcon icon=\"underline\"/>\n        </Button>\n        <Button data-cy={'format-strikethrough'} variant='light' onClick={() => strikeThroughSelection(editor)} title={t('editor.editorToolbar.strikethrough')}>\n          <ForkAwesomeIcon icon=\"strikethrough\"/>\n        </Button>\n        <Button data-cy={'format-subscript'} variant='light' onClick={() => subscriptSelection(editor)} title={t('editor.editorToolbar.subscript')}>\n          <ForkAwesomeIcon icon=\"subscript\"/>\n        </Button>\n        <Button data-cy={'format-superscript'} variant='light' onClick={() => superscriptSelection(editor)} title={t('editor.editorToolbar.superscript')}>\n          <ForkAwesomeIcon icon=\"superscript\"/>\n        </Button>\n      </ButtonGroup>\n      <ButtonGroup className={'mx-1 flex-wrap'}>\n        <Button data-cy={'format-heading'} variant='light' onClick={() => addHeaderLevel(editor)} title={t('editor.editorToolbar.header')}>\n          <ForkAwesomeIcon icon=\"header\"/>\n        </Button>\n        <Button data-cy={'format-code-block'} variant='light' onClick={() => addCodeFences(editor)} title={t('editor.editorToolbar.code')}>\n          <ForkAwesomeIcon icon=\"code\"/>\n        </Button>\n        <Button data-cy={'format-block-quote'} variant='light' onClick={() => addQuotes(editor)} title={t('editor.editorToolbar.blockquote')}>\n          <ForkAwesomeIcon icon=\"quote-right\"/>\n        </Button>\n        <Button data-cy={'format-unordered-list'} variant='light' onClick={() => addList(editor)} title={t('editor.editorToolbar.unorderedList')}>\n          <ForkAwesomeIcon icon=\"list\"/>\n        </Button>\n        <Button data-cy={'format-ordered-list'} variant='light' onClick={() => addOrderedList(editor)} title={t('editor.editorToolbar.orderedList')}>\n          <ForkAwesomeIcon icon=\"list-ol\"/>\n        </Button>\n        <Button data-cy={'format-check-list'} variant='light' onClick={() => addTaskList(editor)} title={t('editor.editorToolbar.checkList')}>\n          <ForkAwesomeIcon icon=\"check-square\"/>\n        </Button>\n      </ButtonGroup>\n      <ButtonGroup className={'mx-1 flex-wrap'}>\n        <Button data-cy={'format-link'} variant='light' onClick={() => addLink(editor)} title={t('editor.editorToolbar.link')}>\n          <ForkAwesomeIcon icon=\"link\"/>\n        </Button>\n        <Button data-cy={'format-image'} variant='light' onClick={() => addImage(editor)} title={t('editor.editorToolbar.image')}>\n          <ForkAwesomeIcon icon=\"picture-o\"/>\n        </Button>\n        <HiddenInputMenuEntry\n          type={'button'}\n          acceptedFiles={supportedMimeTypesJoined}\n          i18nKey={'editor.editorToolbar.uploadImage'}\n          icon={'upload'}\n          onLoad={onUploadImage}\n        />\n      </ButtonGroup>\n      <ButtonGroup className={'mx-1 flex-wrap'}>\n        <TablePickerButton editor={editor}/>\n        <Button data-cy={'format-add-line'} variant='light' onClick={() => addLine(editor)} title={t('editor.editorToolbar.line')}>\n          <ForkAwesomeIcon icon=\"minus\"/>\n        </Button>\n        <Button data-cy={'format-collapsable-block'} variant='light' onClick={() => addCollapsableBlock(editor)} title={t('editor.editorToolbar.collapsableBlock')}>\n          <ForkAwesomeIcon icon=\"caret-square-o-down\"/>\n        </Button>\n        <Button data-cy={'format-add-comment'} variant='light' onClick={() => addComment(editor)} title={t('editor.editorToolbar.comment')}>\n          <ForkAwesomeIcon icon=\"comment\"/>\n        </Button>\n        <EmojiPickerButton editor={editor}/>\n      </ButtonGroup>\n      <ButtonGroup className={'mx-1 flex-wrap'}>\n        <EditorPreferences/>\n      </ButtonGroup>\n    </ButtonToolbar>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport { Editor, EditorChange, EditorConfiguration, ScrollInfo } from 'codemirror'\nimport 'codemirror/addon/comment/comment'\nimport 'codemirror/addon/dialog/dialog'\nimport 'codemirror/addon/display/autorefresh'\nimport 'codemirror/addon/display/fullscreen'\nimport 'codemirror/addon/display/placeholder'\nimport 'codemirror/addon/edit/closebrackets'\nimport 'codemirror/addon/edit/closetag'\nimport 'codemirror/addon/edit/continuelist'\nimport 'codemirror/addon/edit/matchbrackets'\nimport 'codemirror/addon/edit/matchtags'\nimport 'codemirror/addon/fold/foldcode'\nimport 'codemirror/addon/fold/foldgutter'\nimport 'codemirror/addon/fold/markdown-fold'\nimport 'codemirror/addon/hint/show-hint'\nimport 'codemirror/addon/search/jump-to-line'\nimport 'codemirror/addon/search/match-highlighter'\nimport 'codemirror/addon/search/search'\nimport 'codemirror/addon/selection/active-line'\nimport 'codemirror/keymap/emacs'\nimport 'codemirror/keymap/sublime'\nimport 'codemirror/keymap/vim'\nimport 'codemirror/mode/gfm/gfm'\nimport equal from 'fast-deep-equal'\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { Controlled as ControlledCodeMirror } from 'react-codemirror2'\nimport { useTranslation } from 'react-i18next'\nimport { useSelector } from 'react-redux'\nimport { ApplicationState } from '../../../redux'\nimport { MaxLengthWarningModal } from '../editor-modals/max-length-warning-modal'\nimport { ScrollProps, ScrollState } from '../scroll/scroll-props'\nimport { allHinters, findWordAtCursor } from './autocompletion'\nimport './editor-pane.scss'\nimport { defaultKeyMap } from './key-map'\nimport { createStatusInfo, defaultState, StatusBar, StatusBarInfo } from './status-bar/status-bar'\nimport { ToolBar } from './tool-bar/tool-bar'\nimport { handleUpload } from './upload-handler'\n\nexport interface EditorPaneProps {\n  onContentChange: (content: string) => void\n  content: string\n}\n\nconst onChange = (editor: Editor) => {\n  for (const hinter of allHinters) {\n    const searchTerm = findWordAtCursor(editor)\n    if (hinter.wordRegExp.test(searchTerm.text)) {\n      editor.showHint({\n        hint: hinter.hint,\n        completeSingle: false,\n        completeOnSingleClick: false,\n        alignWithWord: true\n      })\n      return\n    }\n  }\n}\n\ninterface PasteEvent {\n  clipboardData: {\n    files: FileList\n  },\n  preventDefault: () => void\n}\n\nconst onPaste = (pasteEditor: Editor, event: PasteEvent) => {\n  if (event && event.clipboardData && event.clipboardData.files && event.clipboardData.files.length > 0) {\n    event.preventDefault()\n    const files: FileList = event.clipboardData.files\n    if (files && files.length >= 1) {\n      handleUpload(files[0], pasteEditor)\n    }\n  }\n}\n\ninterface DropEvent {\n  pageX: number,\n  pageY: number,\n  dataTransfer: {\n    files: FileList\n    effectAllowed: string\n  } | null\n  preventDefault: () => void\n}\n\nexport const EditorPane: React.FC<EditorPaneProps & ScrollProps> = ({ onContentChange, content, scrollState, onScroll, onMakeScrollSource }) => {\n  const { t } = useTranslation()\n  const maxLength = useSelector((state: ApplicationState) => state.config.maxDocumentLength)\n  const [showMaxLengthWarning, setShowMaxLengthWarning] = useState(false)\n  const maxLengthWarningAlreadyShown = useRef(false)\n  const [editor, setEditor] = useState<Editor>()\n  const [statusBarInfo, setStatusBarInfo] = useState<StatusBarInfo>(defaultState)\n  const editorPreferences = useSelector((state: ApplicationState) => state.editorConfig.preferences, equal)\n  const ligaturesEnabled = useSelector((state: ApplicationState) => state.editorConfig.ligatures, equal)\n\n  const lastScrollPosition = useRef<number>()\n  const [editorScroll, setEditorScroll] = useState<ScrollInfo>()\n  const onEditorScroll = useCallback((editor: Editor, data: ScrollInfo) => setEditorScroll(data), [])\n\n  useEffect(() => {\n    if (!editor || !onScroll || !editorScroll) {\n      return\n    }\n    const scrollEventValue = editorScroll.top as number\n    const line = editor.lineAtHeight(scrollEventValue, 'local')\n    const startYOfLine = editor.heightAtLine(line, 'local')\n    const lineInfo = editor.lineInfo(line)\n    if (lineInfo === null) {\n      return\n    }\n    const heightOfLine = (lineInfo.handle as { height: number }).height\n    const percentageRaw = (Math.max(scrollEventValue - startYOfLine, 0)) / heightOfLine\n    const percentage = Math.floor(percentageRaw * 100)\n\n    const newScrollState: ScrollState = { firstLineInView: line + 1, scrolledPercentage: percentage }\n    onScroll(newScrollState)\n  }, [editor, editorScroll, onScroll])\n\n  useEffect(() => {\n    if (!editor || !scrollState) {\n      return\n    }\n    const startYOfLine = editor.heightAtLine(scrollState.firstLineInView - 1, 'local')\n    const heightOfLine = (editor.lineInfo(scrollState.firstLineInView - 1).handle as { height: number }).height\n    const newPositionRaw = startYOfLine + (heightOfLine * scrollState.scrolledPercentage / 100)\n    const newPosition = Math.floor(newPositionRaw)\n    if (newPosition !== lastScrollPosition.current) {\n      lastScrollPosition.current = newPosition\n      editor.scrollTo(0, newPosition)\n    }\n  }, [editor, scrollState])\n\n  const onBeforeChange = useCallback((editor: Editor, data: EditorChange, value: string) => {\n    if (value.length > maxLength && !maxLengthWarningAlreadyShown.current) {\n      setShowMaxLengthWarning(true)\n      maxLengthWarningAlreadyShown.current = true\n    }\n    if (value.length <= maxLength) {\n      maxLengthWarningAlreadyShown.current = false\n    }\n    onContentChange(value)\n  }, [onContentChange, maxLength, maxLengthWarningAlreadyShown])\n  const onEditorDidMount = useCallback(mountedEditor => {\n    setStatusBarInfo(createStatusInfo(mountedEditor, maxLength))\n    setEditor(mountedEditor)\n  }, [maxLength])\n\n  const onCursorActivity = useCallback((editorWithActivity) => {\n    setStatusBarInfo(createStatusInfo(editorWithActivity, maxLength))\n  }, [maxLength])\n\n  const onDrop = useCallback((dropEditor: Editor, event: DropEvent) => {\n    if (event && dropEditor && event.pageX && event.pageY && event.dataTransfer &&\n      event.dataTransfer.files && event.dataTransfer.files.length >= 1) {\n      event.preventDefault()\n      const top: number = event.pageY\n      const left: number = event.pageX\n      const newCursor = dropEditor.coordsChar({ top, left }, 'page')\n      dropEditor.setCursor(newCursor)\n      const files: FileList = event.dataTransfer.files\n      handleUpload(files[0], dropEditor)\n    }\n  }, [])\n\n  const onMaxLengthHide = useCallback(() => setShowMaxLengthWarning(false), [])\n\n  const codeMirrorOptions: EditorConfiguration = useMemo<EditorConfiguration>(() => ({\n    ...editorPreferences,\n    mode: 'gfm',\n    viewportMargin: 20,\n    styleActiveLine: true,\n    lineNumbers: true,\n    lineWrapping: true,\n    showCursorWhenSelecting: true,\n    highlightSelectionMatches: true,\n    inputStyle: 'textarea',\n    matchBrackets: true,\n    autoCloseBrackets: true,\n    matchTags: {\n      bothTags: true\n    },\n    autoCloseTags: true,\n    foldGutter: true,\n    gutters: [\n      'CodeMirror-linenumbers',\n      'authorship-gutters',\n      'CodeMirror-foldgutter'\n    ],\n    extraKeys: defaultKeyMap,\n    flattenSpans: true,\n    addModeClass: true,\n    autoRefresh: true,\n    // otherCursors: true,\n    placeholder: t('editor.placeholder')\n  }), [t, editorPreferences])\n\n  return (\n    <div className={'d-flex flex-column h-100 position-relative'} onMouseEnter={onMakeScrollSource}>\n      <MaxLengthWarningModal show={showMaxLengthWarning} onHide={onMaxLengthHide} maxLength={maxLength}/>\n      <ToolBar\n        editor={editor}\n      />\n      <ControlledCodeMirror\n        className={`overflow-hidden w-100 flex-fill ${ligaturesEnabled ? '' : 'no-ligatures'}`}\n        value={content}\n        options={codeMirrorOptions}\n        onChange={onChange}\n        onPaste={onPaste}\n        onDrop={onDrop}\n        onCursorActivity={onCursorActivity}\n        editorDidMount={onEditorDidMount}\n        onBeforeChange={onBeforeChange}\n        onScroll={onEditorScroll}\n      />\n      <StatusBar {...statusBarInfo} />\n    </div>\n  )\n}\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { isTestMode } from '../../utils/is-test-mode'\n\nexport const editorTestContent = isTestMode() ? '' : `---\ntitle: Features\ndescription: Many features, such wow!\nrobots: noindex\ntags:\n  - hedgedoc\n  - demo\n  - react\nopengraph:\n  title: Features\n---\n# Embedding demo\n[TOC]\n\n## markmap\n\n\n\\`\\`\\`markmap\n# MarkMap\n\n## Pro\n\n### written in typescript\n\n## Cons\n\n### must redeclare types\n\\`\\`\\`\n\n## Vega-Lite\n\n\\`\\`\\`vega-lite\n\n\n{\n  \"$schema\": \"https://vega.github.io/schema/vega-lite/v4.json\",\n  \"description\": \"Reproducing http://robslink.com/SAS/democd91/pyramid_pie.htm\",\n  \"data\": {\n    \"values\": [\n      {\"category\": \"Sky\", \"value\": 75, \"order\": 3},\n      {\"category\": \"Shady side of a pyramid\", \"value\": 10, \"order\": 1},\n      {\"category\": \"Sunny side of a pyramid\", \"value\": 15, \"order\": 2}\n    ]\n  },\n  \"mark\": {\"type\": \"arc\", \"outerRadius\": 80},\n  \"encoding\": {\n    \"theta\": {\n      \"field\": \"value\", \"type\": \"quantitative\",\n      \"scale\": {\"range\": [2.35619449, 8.639379797]},\n      \"stack\": true\n    },\n    \"color\": {\n      \"field\": \"category\", \"type\": \"nominal\",\n      \"scale\": {\n        \"domain\": [\"Sky\", \"Shady side of a pyramid\", \"Sunny side of a pyramid\"],\n        \"range\": [\"#416D9D\", \"#674028\", \"#DEAC58\"]\n      },\n      \"legend\": {\n        \"orient\": \"none\",\n        \"title\": null,\n        \"columns\": 1,\n        \"legendX\": 200,\n        \"legendY\": 80\n      }\n    },\n    \"order\": {\n      \"field\": \"order\"\n    }\n  },\n  \"view\": {\"stroke\": null}\n}\n\n\\`\\`\\`\n\n## GraphViz\n\n\\`\\`\\`graphviz\ngraph {\n  a -- b\n  a -- b\n  b -- a [color=blue]\n}\n\\`\\`\\`\n\n\\`\\`\\`graphviz\ndigraph structs {\n  node [shape=record];\n  struct1 [label=\"<f0> left|<f1> mid&#92; dle|<f2> right\"];\n  struct2 [label=\"<f0> one|<f1> two\"];\n  struct3 [label=\"hello&#92;nworld |{ b |{c|<here> d|e}| f}| g | h\"];\n  struct1:f1 -> struct2:f0;\n  struct1:f2 -> struct3:here;\n}\n\\`\\`\\`\n\n\\`\\`\\`graphviz\ndigraph G {\n  main -> parse -> execute;\n  main -> init;\n  main -> cleanup;\n  execute -> make_string;\n  execute -> printf\n  init -> make_string;\n  main -> printf;\n  execute -> compare;\n}\n\\`\\`\\`\n\n\\`\\`\\`graphviz\ndigraph D {\n    node [fontname=\"Arial\"];\n    node_A [shape=record    label=\"shape=record|{above|middle|below}|right\"];\n    node_B [shape=plaintext label=\"shape=plaintext|{curly|braces and|bars without}|effect\"];\n}\n\\`\\`\\`\n\n\\`\\`\\`graphviz\ndigraph D {\n  A -> {B, C, D} -> {F}\n}\n\\`\\`\\`\n\n## High Res Image\n\n![Wheat Field with Cypresses](/img/highres.jpg)\n\n## Sequence Diagram (deprecated)\n\n\\`\\`\\`sequence\nTitle: Here is a title\nnote over A: asdd\nA->B: Normal line\nB-->C: Dashed line\nC->>D: Open arrow\nD-->>A: Dashed open arrow\nparticipant IOOO\n\\`\\`\\`\n\n## Mermaid\n\n\\`\\`\\`mermaid\ngantt\n  title A Gantt Diagram\n\n  section Section\n  A task: a1, 2014-01-01, 30d\n  Another task: after a1, 20d\n\n  section Another\n  Task in sec: 2014-01-12, 12d\n  Another task: 24d\n\\`\\`\\`\n\n## Flowchart\n\n\\`\\`\\`flow\nst=>start: Start\ne=>end: End\nop=>operation: My Operation\nop2=>operation: lalala\ncond=>condition: Yes or No?\n\nst->op->op2->cond\ncond(yes)->e\ncond(no)->op2\n\\`\\`\\`\n\n## ABC\n\n\\`\\`\\`abc\nX:1\nT:Speed the Plough\nM:4/4\nC:Trad.\nK:G\n|:GABc dedB|dedB dedB|c2ec B2dB|c2A2 A2BA|\nGABc dedB|dedB dedB|c2ec B2dB|A2F2 G4:|\n|:g2gf gdBd|g2f2 e2d2|c2ec B2dB|c2A2 A2df|\ng2gf g2Bd|g2f2 e2d2|c2ec B2dB|A2F2 G4:|\n\\`\\`\\`\n\n## CSV\n\n\\`\\`\\`csv delimiter=; header\nUsername; Identifier;First name;Last name\n\"booker12; rbooker\";9012;Rachel;Booker\ngrey07;2070;Laura;Grey\njohnson81;4081;Craig;Johnson\njenkins46;9346;Mary;Jenkins\nsmith79;5079;Jamie;Smith\n\\`\\`\\`\n\n## some plain text\n\nLorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.\n\n## KaTeX\nYou can render *LaTeX* mathematical expressions using **KaTeX**, as on [math.stackexchange.com](https://math.stackexchange.com/):\n\nThe *Gamma function* satisfying $\\\\Gamma(n) = (n-1)!\\\\quad\\\\forall n\\\\in\\\\mathbb N$ is via the Euler integral\n\n$$\nx = {-b \\\\pm \\\\sqrt{b^2-4ac} \\\\over 2a}.\n$$\n\n$$\n\\\\Gamma(z) = \\\\int_0^\\\\infty t^{z-1}e^{-t}dt\\\\,.\n$$\n\n> More information about **LaTeX** mathematical expressions [here](https://meta.math.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference).\n\n## Blockquote\n> Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.\n> Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.\n> [color=red] [name=John Doe] [time=2020-06-21 22:50]\n\n## Slideshare\n{%slideshare mazlan1/internet-of-things-the-tip-of-an-iceberg %}\n\n## Gist\nhttps://gist.github.com/schacon/1\n\n## YouTube\nhttps://www.youtube.com/watch?v=YE7VzlLtp-4\n\n## Vimeo\nhttps://vimeo.com/23237102\n\n## Asciinema\nhttps://asciinema.org/a/117928\n\n## PDF\n{%pdf https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf %}\n\n## Code highlighting\n\\`\\`\\`js=\nvar s = \"JavaScript syntax highlighting\";\nalert(s);\nfunction $initHighlight(block, cls) {\n  try {\n    if (cls.search(/\\\\bno\\\\-highlight\\\\b/) != -1)\n      return process(block, true, 0x0F) +\n             ' class=\"\"';\n  } catch (e) {\n    /* handle exception */\n  }\n  for (var i = 0 / 2; i < classes.length; i++) {\n    if (checkCondition(classes[i]) === undefined)\n      return /\\\\d+[\\\\s/]/g;\n  }\n}\n\\`\\`\\`\n\n## PlantUML\n\\`\\`\\`plantuml\n@startuml\nparticipant Alice\nparticipant \"The **Famous** Bob\" as Bob\n\nAlice -> Bob : hello --there--\n... Some ~~long delay~~ ...\nBob -> Alice : ok\nnote left\n  This is **bold**\n  This is //italics//\n  This is \"\"monospaced\"\"\n  This is --stroked--\n  This is __underlined__\n  This is ~~waved~~\nend note\n\nAlice -> Bob : A //well formatted// message\nnote right of Alice\n This is <back:cadetblue><size:18>displayed</size></back>\n __left of__ Alice.\nend note\nnote left of Bob\n <u:red>This</u> is <color #118888>displayed</color>\n **<color purple>left of</color> <s:red>Alice</strike> Bob**.\nend note\nnote over Alice, Bob\n <w:#FF33FF>This is hosted</w> by <img sourceforge.jpg>\nend note\n@enduml\n\\`\\`\\`\n\n## ToDo List\n\n- [ ] ToDos\n  - [X] Buy some salad\n  - [ ] Brush teeth\n  - [x] Drink some water\n  - [ ] **Click my box** and see the source code, if you're allowed to edit!\n\n`\n","/*\n * SPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { useEffect } from 'react'\nimport { setEditorMode } from '../../../redux/editor/methods'\nimport { EditorMode } from '../app-bar/editor-view-mode'\n\nconst shortcutHandler = (event: KeyboardEvent): void => {\n  if (event.ctrlKey && event.altKey && event.key === 'b') {\n    setEditorMode(EditorMode.BOTH)\n    event.preventDefault()\n  }\n\n  if (event.ctrlKey && event.altKey && event.key === 'v') {\n    setEditorMode(EditorMode.PREVIEW)\n    event.preventDefault()\n  }\n\n  if (event.ctrlKey && event.altKey && (event.key === 'e' || event.key === '')) {\n    setEditorMode(EditorMode.EDITOR)\n    event.preventDefault()\n  }\n}\n\nexport const useViewModeShortcuts = ():void => {\n  useEffect(() => {\n    document.addEventListener('keydown', shortcutHandler, false)\n    return () => {\n      document.removeEventListener('keydown', shortcutHandler, false)\n    }\n  }, [])\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React from 'react'\nimport './split-divider.scss'\n\nexport interface SplitDividerProps {\n  onGrab: () => void\n}\n\nexport const SplitDivider: React.FC<SplitDividerProps> = ({ onGrab }) => {\n  return (\n    <div\n      onMouseDown={() => onGrab()}\n      onTouchStart={() => onGrab()}\n      className={'split-divider'}/>\n  )\n}\n","/*\nSPDX-FileCopyrightText: 2021 The HedgeDoc developers (see AUTHORS file)\n\nSPDX-License-Identifier: AGPL-3.0-only\n*/\n\nimport React, { ReactElement, useRef, useState } from 'react'\nimport { ShowIf } from '../../common/show-if/show-if'\nimport { SplitDivider } from './split-divider/split-divider'\nimport './splitter.scss'\n\nexport interface SplitterProps {\n  left: ReactElement\n  right: ReactElement\n  containerClassName?: string\n  showLeft: boolean\n  showRight: boolean\n}\n\nexport const Splitter: React.FC<SplitterProps> = ({ containerClassName, left, right, showLeft, showRight }) => {\n  const [split, setSplit] = useState(50)\n  const realSplit = Math.max(0, Math.min(100, (showRight ? split : 100)))\n  const [doResizing, setDoResizing] = useState(false)\n  const splitContainer = useRef<HTMLDivElement>(null)\n\n  const recalculateSize = (mouseXPosition: number): void => {\n    if (!splitContainer.current) {\n      return\n    }\n    const x = mouseXPosition - splitContainer.current.offsetLeft\n\n    const newSize = x / splitContainer.current.clientWidth\n    setSplit(newSize * 100)\n  }\n\n  return (\n    <div ref={splitContainer} className={`flex-fill flex-row d-flex ${containerClassName || ''}`}\n      onMouseUp={() => setDoResizing(false)}\n      onTouchEnd={() => setDoResizing(false)}\n      onMouseMove={(mouseEvent) => {\n        if (doResizing) {\n          recalculateSize(mouseEvent.pageX)\n          mouseEvent.preventDefault()\n        }\n      }}\n      onTouchMove={(touchEvent) => {\n        if (doResizing) {\n          recalculateSize(touchEvent.touches[0].pageX)\n        }\n      }}\n    >\n      <div className={`splitter left ${!showLeft ? 'd-none' : ''}`} style={{ flexBasis: `calc(${realSplit}% - 5px)` }}>\n        {left}\n      </div>\n      <ShowIf condition={showLeft && showRight}>\n        <div className='splitter separator'>\n          <SplitDivider onGrab={() => setDoResizing(true)}/>\n        </div>\n      </ShowIf>\n      <div className={`splitter right ${!showRight ? 'd-none' : ''}`}>\n        {right}\n      </div>\n    </div>\n  )\n}\n"],"sourceRoot":""}